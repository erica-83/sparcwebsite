<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PD1XQ0NDCD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-PD1XQ0NDCD');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete your donation to SPARC. Support community-integrated day programs for adults with severe and multiple disabilities.">
    <title>Donate | SPARC - Specially Adapted Resource Centers</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">

    <style>
        .checkout-section {
            padding: 60px 0 80px;
        }
        .checkout-container {
            max-width: 700px;
            margin: 0 auto;
            background: var(--white);
            padding: 40px;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
        }
        .checkout-container > h2 {
            font-family: var(--font-heading);
            color: var(--sparc-dark-navy);
            font-size: 1.5rem;
            margin-bottom: 8px;
        }
        .checkout-container > p {
            color: var(--medium-gray);
            margin-bottom: 25px;
        }

        /* ========== Bloomerang Donation Form Overrides ========== */
        #donation-form-container .donation-form {
            font-family: var(--font-primary);
        }
        #donation-form-container .donation-form label {
            color: var(--sparc-charcoal);
            font-family: var(--font-primary);
            font-weight: 400;
        }
        #donation-form-container .donation-form .section {
            padding: 15px 0;
        }
        #donation-form-container .donation-form h3 {
            font-family: var(--font-heading);
            color: var(--sparc-dark-navy);
            font-size: 1.15rem;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--sparc-kelly-green);
        }

        /* Donation level radio buttons - card style */
        #donation-form-container .donation-form .section.donation .field.radio {
            margin-bottom: 6px;
        }
        #donation-form-container .donation-form .section.donation .field.radio label {
            display: flex;
            align-items: flex-start;
            padding: 12px 14px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all var(--transition-fast);
            gap: 10px;
            line-height: 1.4;
        }
        #donation-form-container .donation-form .section.donation .field.radio label:hover {
            border-color: var(--sparc-royal-blue);
            background: rgba(0, 83, 155, 0.03);
        }
        #donation-form-container .donation-form .section.donation .field.radio input[type="radio"] {
            width: 18px;
            height: 18px;
            margin-top: 2px;
            accent-color: var(--sparc-royal-blue);
            flex-shrink: 0;
        }
        #donation-form-container .donation-form .section.donation .field.radio:has(input:checked) label {
            border-color: var(--sparc-royal-blue);
            background: rgba(0, 83, 155, 0.05);
        }
        #donation-form-container .donation-form .section.donation .field.radio:has(input:checked) .label {
            font-weight: 600;
            color: var(--sparc-dark-navy);
        }

        /* Other amount */
        #donation-form-container .donation-form #other-amount {
            width: 100%;
            max-width: 200px;
            padding: 10px 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--font-primary);
        }

        /* Text inputs, selects, textareas */
        #donation-form-container .donation-form .field input[type="text"],
        #donation-form-container .donation-form .field input[type="email"],
        #donation-form-container .donation-form .field input[type="tel"],
        #donation-form-container .donation-form .field input[type="number"],
        #donation-form-container .donation-form .field input[type="date"],
        #donation-form-container .donation-form .field select,
        #donation-form-container .donation-form .field textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: var(--font-primary);
            transition: border-color var(--transition-fast);
            box-sizing: border-box;
        }
        #donation-form-container .donation-form .field input:focus,
        #donation-form-container .donation-form .field select:focus,
        #donation-form-container .donation-form .field textarea:focus {
            border-color: var(--sparc-royal-blue);
            outline: none;
        }
        #donation-form-container .donation-form .field label .label {
            font-weight: 500;
        }
        #donation-form-container .donation-form .field {
            padding: 8px 0;
        }

        /* Checkbox sections (recurring, true impact, consent) */
        #donation-form-container .donation-form .section.recurring label,
        #donation-form-container .donation-form .section.true-impact label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        #donation-form-container .donation-form input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--sparc-royal-blue);
        }

        /* Payment type radios - inline pill style */
        #donation-form-container .donation-form .section.payment .field.radio {
            display: inline-block;
            margin-right: 6px;
            margin-bottom: 8px;
        }
        #donation-form-container .donation-form .section.payment .field.radio label {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 14px;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 0.9rem;
        }
        #donation-form-container .donation-form .section.payment .field.radio label:hover {
            border-color: var(--sparc-royal-blue);
        }
        #donation-form-container .donation-form .section.payment .field.radio:has(input:checked) label {
            border-color: var(--sparc-royal-blue);
            background: rgba(0, 83, 155, 0.05);
            font-weight: 600;
        }

        /* Stripe card element */
        #donation-form-container #card-element {
            padding: 12px 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
        }
        #donation-form-container #card-errors {
            color: #c0392b;
            font-size: 0.85rem;
            margin-top: 6px;
        }

        /* Submit button */
        #donation-form-container .btn-submit-donation {
            background: var(--sparc-kelly-green) !important;
            color: white !important;
            border: none !important;
            padding: 16px 40px !important;
            font-size: 1.1rem !important;
            font-weight: 600 !important;
            font-family: var(--font-heading) !important;
            border-radius: 8px !important;
            cursor: pointer !important;
            width: 100% !important;
            text-transform: uppercase !important;
            letter-spacing: 0.5px !important;
            transition: background 0.3s ease, transform 0.3s ease !important;
            margin-top: 10px;
        }
        #donation-form-container .btn-submit-donation:hover:not(.disabled) {
            background: var(--sparc-kelly-green-dark) !important;
            transform: translateY(-2px);
        }
        #donation-form-container .btn-submit-donation.disabled {
            opacity: 0.6;
            cursor: not-allowed !important;
        }

        /* PayPal button */
        #donation-form-container #paypal-button-container {
            margin-top: 15px;
        }

        /* Errors */
        #donation-form-container .donation-form .errors {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #991b1b;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        /* Success & Processing states */
        #donation-form-container .donation-success,
        #donation-processing-container {
            text-align: center;
            padding: 40px 20px;
        }
        #donation-form-container .donation-success h2,
        #donation-processing-container h2 {
            color: var(--sparc-dark-navy);
            font-family: var(--font-heading);
            margin-bottom: 10px;
        }
        #donation-form-container .donation-success p,
        #donation-processing-container p {
            color: var(--sparc-charcoal);
            font-size: 1.05rem;
        }

        /* Required star */
        #donation-form-container .required-star {
            color: #c0392b;
        }

        /* Validation error labels */
        #donation-form-container label.error {
            color: #c0392b !important;
            font-size: 0.85rem;
            font-weight: 400;
            padding: 2px 0 !important;
        }

        /* Recurring info label */
        #donation-form-container .recurring-paypal-venmo-label-info .label {
            font-size: 0.85rem;
            color: var(--medium-gray);
            font-style: italic;
        }

        @media (max-width: 768px) {
            #donation-form-container .donation-form .section.payment .field.radio {
                display: block;
                margin-right: 0;
            }
            .checkout-container {
                padding: 25px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Skip to Content Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <a href="home.html" class="logo">
                <img src="images/logo.png" alt="SPARC - Specially Adapted Resource Centers" style="height: 50px; width: auto;">
            </a>

            <ul class="nav-menu">
                <li><a href="home.html" class="nav-link">Home</a></li>
                <li class="nav-item-dropdown">
                    <a href="about.html" class="nav-link">About</a>
                    <div class="dropdown-menu">
                        <a href="team.html">Our Team</a>
                        <a href="board.html">Board of Directors</a>
                        <a href="financials.html">Financials</a>
                        <a href="strategic-plan.html">Strategic Plan</a>
                        <a href="news.html">SPARC in the News</a>
                        <a href="ada-compliance.html">ADA Compliance</a>
                    </div>
                </li>
                <li><a href="programs.html" class="nav-link">Programs</a></li>
                <li><a href="locations.html" class="nav-link">Locations</a></li>
                <li class="nav-item-dropdown">
                    <a href="stories.html" class="nav-link">Stories</a>
                    <div class="dropdown-menu">
                        <a href="blog.html">Blog</a>
                        <a href="newsletter.html">Newsletter</a>
                    </div>
                </li>
                <li class="nav-item-dropdown">
                    <a href="events.html" class="nav-link">Events</a>
                    <div class="dropdown-menu">
                        <a href="gala.html">An Evening to SPARCle</a>
                        <a href="summit.html">A Call to Conscience</a>
                        <a href="bingo.html">Bingo</a>
                    </div>
                </li>
                <li class="nav-item-dropdown">
                    <a href="get-involved.html" class="nav-link">Get Involved</a>
                    <div class="dropdown-menu">
                        <a href="advocate.html">Advocate for SPARC</a>
                        <a href="get-involved.html">Volunteer</a>
                        <a href="participants.html">Participants & Families</a>
                        <a href="javascript:void(0)" onclick="openMailingListModal()">Join Our Mailing List</a>
                        <a href="https://teamlocker.squadlocker.com/#/lockers/specially-adapted-resource-centers" target="_blank" rel="noopener noreferrer">Purchase SPARC Swag</a>
                    </div>
                </li>
                <li><a href="donate-checkout.html" class="nav-link nav-donate active">Donate</a></li>
            </ul>

            <div class="mobile-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>Complete Your Donation</h1>
            <p>Your generous gift supports adults with disabilities in community-based programs</p>
        </div>
    </section>

    <!-- Main Content -->
    <main id="main-content">
        <section class="checkout-section">
            <div class="container">
                <div class="checkout-container" id="donate-form">
                    <h2>Make a Donation</h2>
                    <p>Select an amount, fill out your information, and choose a payment method. Secure processing via Stripe, PayPal, or Venmo.</p>

                    <script type="text/javascript" id="bloomerangForm4947968"></script>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer" style="color: white;">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-about">
                    <img src="images/SPARC_logo_white.png" alt="SPARC" style="height: 60px; width: auto; margin-bottom: 15px;">
                    <p>Specially Adapted Resource Centers provides community-integrated day programs for adults with severe and multiple disabilities in Northern Virginia. We believe every adult deserves a meaningful life filled with connection, purpose, and belonging.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/profile.php?id=100064372517571" class="social-link" aria-label="Facebook" target="_blank">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
                        </a>
                        <a href="https://www.instagram.com/sparc.solutions/" class="social-link" aria-label="Instagram" target="_blank">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                        </a>
                        <a href="https://www.linkedin.com/company/specially-adapted-resource-centers" class="social-link" aria-label="LinkedIn" target="_blank">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                        </a>
                        <a href="https://www.youtube.com/@SPARC_VA" class="social-link" aria-label="YouTube" target="_blank">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
                        </a>
                        <a href="mailto:debi@sparcsolutions.org" class="social-link" aria-label="Email">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M22 6l-10 7L2 6"/></svg>
                        </a>
                    </div>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="programs.html">Programs</a></li>
                        <li><a href="locations.html">Locations &amp; Pricing</a></li>
                        <li><a href="events.html">Events</a></li>
                        <li><a href="stories.html">Stories &amp; Impact</a></li>
                        <li><a href="donate-checkout.html">Donate</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="faq.html">FAQs</a></li>
                        <li><a href="financials.html">Annual Reports</a></li>
                        <li><a href="board.html">Board of Directors</a></li>
                        <li><a href="news.html">News &amp; Press</a></li>
                        <li><a href="get-involved.html">Get Involved</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4>Contact</h4>
                    <p><strong>Mailing Address:</strong><br>
                    1775 Tysons Blvd., Fifth Floor<br>
                    Tysons, VA 22102</p>
                    <p><strong>Phone:</strong> <a href="tel:571-407-1807" style="color: white;">(571) 407-1807</a></p>
                    <p><a href="mailto:debi@sparcsolutions.org" style="color: white;">debi@sparcsolutions.org</a></p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Footer Bottom Bar -->
    <div style="background: white; padding: 30px 0; color: var(--sparc-dark-navy);">
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <p style="margin: 0 0 5px 0; color: var(--sparc-dark-navy);">&copy; 2025 SPARC - Specially Adapted Resource Centers. All rights reserved.</p>
                <p style="margin: 0 0 10px 0; color: var(--sparc-dark-navy);">501(c)(3) Nonprofit Organization | EIN: 20-5513060</p>
                <nav aria-label="Legal links">
                    <a href="accessibility.html" style="color: var(--sparc-dark-navy); text-decoration: none;">Accessibility</a> |
                    <a href="faq.html" style="color: var(--sparc-dark-navy); text-decoration: none;">FAQs</a> |
                    <a href="contact.html" style="color: var(--sparc-dark-navy); text-decoration: none;">Contact</a>
                </nav>
            </div>
            <img src="images/Powered by Google.png" alt="Powered by Google" style="height: 160px; width: auto;">
        </div>
    </div>

    <script src="js/main.js"></script>

    <script>
        // Auto-select donation level and/or recurring from query params
        document.addEventListener('DOMContentLoaded', function() {
            var params = new URLSearchParams(window.location.search);
            var level = params.get('level');
            var recurring = params.get('recurring');

            if (level) {
                var checkLevel = setInterval(function() {
                    var radio = document.getElementById(level);
                    if (radio) {
                        clearInterval(checkLevel);
                        radio.checked = true;
                        radio.click();
                        var event = new Event('change', { bubbles: true });
                        radio.dispatchEvent(event);
                    }
                }, 500);
                setTimeout(function() { clearInterval(checkLevel); }, 10000);
            }

            if (recurring === 'true') {
                var checkRecurring = setInterval(function() {
                    var checkbox = document.getElementById('recurring');
                    if (checkbox) {
                        clearInterval(checkRecurring);
                        if (!checkbox.checked) {
                            checkbox.checked = true;
                            checkbox.click();
                            var event = new Event('change', { bubbles: true });
                            checkbox.dispatchEvent(event);
                        }
                    }
                }, 500);
                setTimeout(function() { clearInterval(checkRecurring); }, 10000);
            }
        });
    </script>

<!-- Bloomerang Donation Form Script -->
<script type="text/javascript">
    var insertForm4947968 = function() {
        var html4947968 = '<style text=\'text/css\'>' + 
'.donation-form label{color: #404040;' + 
'                display: block;}' + 
'' + 
'.donation-form label.error,' + 
'                     .donation-form #card-errors{color: #900;}' + 
'' + 
'.donation-form label.error{display: block;' + 
'                padding: 0 10px;}' + 
'' + 
'.donation-form section{padding: 5px;}' + 
'' + 
'.donation-form .field{padding: 4px 0;}' + 
'' + 
'.donation-form .field .required-star{color: #aa0000; ' + 
'                display: inline-block; ' + 
'                margin-left: 5px;}' + 
'' + 
'.donation-form .field .checkboxes{max-width:275px;' + 
'                border: 1px solid #A9A9A9;' + 
'                -webkit-transition: all .3s ease-out;' + 
'                -moz-transition: all .3s ease-out;' + 
'                transition: all .3s ease-out;}' + 
'' + 
'.donation-form .field .checkbox{display:block;' + 
'                position:relative;' + 
'                -moz-box-sizing:border-box;' + 
'                box-sizing:border-box;' + 
'                height:30px;' + 
'                line-height:26px;' + 
'                padding:2px 28px 2px 8px;' + 
'                border-bottom:1px solid rgba(0,0,0,0.1);' + 
'                color:#404040;  ' + 
'                overflow:hidden;' + 
'                text-decoration:none; }' + 
'' + 
'.donation-form .field .checkbox input{opacity:0.01;' + 
'                position:absolute;' + 
'                left:-50px;  ' + 
'                z-index:-5;}' + 
'' + 
'.donation-form .field .checkbox:last-child{border-bottom:none;}' + 
'' + 
'.donation-form .field .checkbox.selected{background: rgb(50, 142, 253);' + 
'                color:#fff; }' + 
'' + 
'.donation-form .field .checkbox.selected:before{color:#fff;' + 
'                line-height:30px;' + 
'                position:absolute;' + 
'                right:10px; }' + 
'' + 
'.donation-form .field input,' + 
'                     .donation-form .field select,' + 
'                     .donation-form .field textarea,' + 
'                     .donation-form #card-element,' + 
'                     .donation-form #paypal-button-container{padding: 4px; ' + 
'                max-width: 275px;' + 
'                width: 96%}' + 
'' + 
'.donation-form .start-date label.error{padding: 4px; ' + 
'                max-width: 350px;' + 
'                width: 96%}' + 
'' + 
'.donation-form .field .StripeElement{background-color: white;' + 
'                background-color: -moz-field;' + 
'                border: 1px solid darkgray;' + 
'                display: inline-block;}' + 
'' + 
'.donation-form .field textarea.international{height: 120px;}' + 
'' + 
'.donation-form .field select{box-sizing: content-box;}' + 
'' + 
'.donation-form .field.radio label,' + 
'                     .donation-form .field.checkbox label{display: inline-block;}' + 
'' + 
'.donation-form .field.radio input,' + 
'                     .donation-form .field.checkbox input{width: auto;' + 
'                margin-left:0;}' + 
'' + 
'.donation-form .section.consent .field.checkbox:not(.consent-all){margin-left: 20px;}' + 
'' + 
'.donation-form #cardExpirationMonth,' + 
'                     .donation-form #cardExpirationYear{width: 85px;}' + 
'' + 
'.donation-form #security-code{width: 55px;}' + 
'' + 
'.donation-form .field .sidenote{color: #999;' + 
'                font-size: 10px; }' + 
'' + 
'.donation-form .field.other-option,' + 
'                     .donation-form .field.other-amount,' + 
'                     .donation-form .field.cardExpirationMonth,' + 
'                     .donation-form .field.cardExpirationYear{display: inline-block;}' + 
'' + 
'.donation-form .field.other-amount{padding-left: 6px;}' + 
'' + 
'.donation-form .field.cardExpirationMonth{padding-right: 20px;}' + 
'' + 
'.donation-form #other-amount{width: 65px;}' + 
'' + 
'.donation-form .errors{border: 1px solid #900;' + 
'                color: #900;  ' + 
'                padding: 10px;}' + 
'' + 
'.donation-form .radio label.error{display: inline-block;' + 
'                padding-right: 86%;  ' + 
'                float: right;}' + 
'' + 
'.donation-form .hidden{display: none;}' + 
'' + 
'.btn-group .btn-submit-donation{padding: 4px 10px;}' + 
'' + 
'iframe#spreedly-iframe[style=\'visibility: hidden;\']{display: none;}' + 
'' + 
'input, select, textarea, button{font-family: inherit;}' + 
'' + 
'#spreedly-modal-overlay[style="visibility:hidden"]{display: none;}' + 
'' + 
'</style>' + 
'' + 
'<div id="donation-form-container">' + 
'  <form id="donation-form" class="donation-form" method="post" onsubmit="event.preventDefault(); collectPayment();">' + 
'    <div class="errors hidden"></div>' + 
'    <div class="section donation">' + 
'      <h3>Donation</h3>' + 
'      <div class="field radio 4948992 required" >' + 
'<label for="4948992"><input id="4948992" name="donation-level" class="required" type="radio" value="10.000000" maxlength="255"></input><span class="label">$10.00 - Stock a day of materials that make learning, creating, and practicing skills possible.</span></label>' + 
'</div>' + 
'<div class="field radio 4948993 required" >' + 
'<label for="4948993"><input id="4948993" name="donation-level" class="required" type="radio" value="50.000000" maxlength="255"></input><span class="label">$50.00 - Power a structured life skills class that builds real-world confidenceâ€”step by step, skill by skill.</span></label>' + 
'</div>' + 
'<div class="field radio 4948994 required" >' + 
'<label for="4948994"><input id="4948994" name="donation-level" class="required" type="radio" value="100.000000" maxlength="255"></input><span class="label">$100.00 - Make an inclusive community outing possible for 10 people, creating connection and belonging.</span></label>' + 
'</div>' + 
'<div class="field radio 4948995 required" >' + 
'<label for="4948995"><input id="4948995" name="donation-level" class="required" type="radio" value="250.000000" maxlength="255"></input><span class="label">$250.00 - Sponsor a month of Zumba for 30 participants.</span></label>' + 
'</div>' + 
'<div class="field radio 4948996 required" >' + 
'<label for="4948996"><input id="4948996" name="donation-level" class="required" type="radio" value="475.000000" maxlength="255"></input><span class="label">$475.00 - Provide 10 weeks of skills classes that create steady progress over time.</span></label>' + 
'</div>' + 
'<div class="field radio 4948997 required" >' + 
'<label for="4948997"><input id="4948997" name="donation-level" class="required" type="radio" value="750.000000" maxlength="255"></input><span class="label">$750.00 - Cover one month of SPARC attendance, ensuring structure, support, and growth.</span></label>' + 
'</div>' + 
'<div class="field radio 4948998 required" >' + 
'<label for="4948998"><input id="4948998" name="donation-level" class="required" type="radio" value="2500.000000" maxlength="255"></input><span class="label">$2,500.00 - Equip a non-verbal participant with assistive technology that strengthens communication and choice.</span></label>' + 
'</div>' + 
'<div class="field radio 4948999 required" >' + 
'<label for="4948999"><input id="4948999" name="donation-level" class="required" type="radio" value="9000.000000" maxlength="255"></input><span class="label">$9,000.00 - Sponsor a full year of daily SPARC attendance, delivering consistent support and life-changing momentum.</span></label>' + 
'</div>' + 
'<div class="field radio other-option required" >' + 
'<label for="other-option"><input id="other-option" name="donation-level" class="required" type="radio" maxlength="255"></input><span class="label">Other</span></label>' + 
'</div>' + 
'<div class="field text other-amount" >' + 
'<input id="other-amount" name="other-amount" class="otherAmount" type="text" placeholder="$0.00"></input>' + 
'</div>' + 
'' + 
'</div>' + 
'    <div class="section recurring">' + 
'      <div class="field checkbox recurring" >' + 
'<label for="recurring"><input id="recurring" name="recurring" type="checkbox" maxlength="255"></input><span class="label">Show my support by making this a recurring donation</span></label>' + 
'</div>' + 
'<div class="field label recurring-paypal-venmo-label-info" >' + 
'<label for="recurring-paypal-venmo-label-info"><span class="label">(Not available for payments made through PayPal or Venmo.)</span></label>' + 
'<html id="recurring-paypal-venmo-label-info" name="recurring-paypal-venmo-label-info" type="label" maxlength="255"></html>' + 
'</div>' + 
'<div class="field  frequency required" style="display: none">' + 
'<label for="frequency">Frequency<span class="required-star">*</span></label>' + 
'<select id="frequency" name="frequency" class="required"><option value=""></option>' + 
'<option value="Weekly">Weekly</option>' + 
'<option value="Monthly" selected>Monthly</option>' + 
'<option value="Quarterly">Quarterly</option>' + 
'<option value="SemiAnnually">Every six months</option>' + 
'<option value="Yearly">Yearly</option>' + 
'</select>' + 
'</div>' + 
'<div class="field date start-date required" style="display: none">' + 
'<label for="start-date"><span class="label">Start Date</span><span class="required-star">*</span></label>' + 
'<input id="start-date" name="start-date" class="validDate startDateVenmo required" type="date" placeholder="mm/dd/yyyy"></input>' + 
'</div>' + 
'' + 
'</div>' + 
'    ' + 
'    <div class="section true-impact">' + 
'      <div class="field checkbox true-impact" >' + 
'<label for="true-impact"><input id="true-impact" name="true-impact" type="checkbox" maxlength="255"></input><span class="label">Add [amount] to help cover our transaction fees</span></label>' + 
'</div>' + 
'' + 
'</div>' + 
'    ' + 
'    <div class="section contact">' + 
'      <h3>Contact Information</h3>' + 
'      <div class="field text first-name required" >' + 
'<label for="first-name"><span class="label">First Name</span><span class="required-star">*</span></label>' + 
'<input id="first-name" name="first-name" class="required" type="text"></input>' + 
'</div>' + 
'<div class="field text last-name required" >' + 
'<label for="last-name"><span class="label">Last Name</span><span class="required-star">*</span></label>' + 
'<input id="last-name" name="last-name" class="required" type="text"></input>' + 
'</div>' + 
'<div class="field email email-address required" >' + 
'<label for="email-address"><span class="label">Email</span><span class="required-star">*</span></label>' + 
'<input id="email-address" name="email-address" class="email required" type="email" placeholder="someone@website.com"></input>' + 
'</div>' + 
'<div class="field tel phone-number" >' + 
'<label for="phone-number"><span class="label">Phone</span></label>' + 
'<input id="phone-number" name="phone-number" class="phoneUS" type="tel"></input>' + 
'</div>' + 
'' + 
'</div>' + 
'    <div class="section billing-address">' + 
'      <div class="field  country required" >' + 
'<label for="country">Country<span class="required-star">*</span></label>' + 
'<select id="country" name="country" class="required"><option value=""></option>' + 
'<option value="AF">Afghanistan</option>' + 
'<option value="AX">Aland Islands</option>' + 
'<option value="AL">Albania</option>' + 
'<option value="DZ">Algeria</option>' + 
'<option value="AS">American Samoa</option>' + 
'<option value="AD">Andorra</option>' + 
'<option value="AO">Angola</option>' + 
'<option value="AI">Anguilla</option>' + 
'<option value="AQ">Antarctica</option>' + 
'<option value="AG">Antigua and Barbuda</option>' + 
'<option value="AR">Argentina</option>' + 
'<option value="AM">Armenia</option>' + 
'<option value="AW">Aruba</option>' + 
'<option value="AU">Australia</option>' + 
'<option value="AT">Austria</option>' + 
'<option value="AZ">Azerbaijan</option>' + 
'<option value="BS">Bahamas</option>' + 
'<option value="BH">Bahrain</option>' + 
'<option value="BD">Bangladesh</option>' + 
'<option value="BB">Barbados</option>' + 
'<option value="BY">Belarus</option>' + 
'<option value="BE">Belgium</option>' + 
'<option value="BZ">Belize</option>' + 
'<option value="BJ">Benin</option>' + 
'<option value="BM">Bermuda</option>' + 
'<option value="BT">Bhutan</option>' + 
'<option value="BO">Bolivia</option>' + 
'<option value="BA">Bosnia and Herzegovina</option>' + 
'<option value="BW">Botswana</option>' + 
'<option value="BV">Bouvet Island</option>' + 
'<option value="BR">Brazil</option>' + 
'<option value="IO">British Indian Ocean Territory</option>' + 
'<option value="BN">Brunei Darussalam</option>' + 
'<option value="BG">Bulgaria</option>' + 
'<option value="BF">Burkina Faso</option>' + 
'<option value="BI">Burundi</option>' + 
'<option value="KH">Cambodia</option>' + 
'<option value="CM">Cameroon</option>' + 
'<option value="CA">Canada</option>' + 
'<option value="CV">Cape Verde</option>' + 
'<option value="KY">Cayman Islands</option>' + 
'<option value="CF">Central African Republic</option>' + 
'<option value="TD">Chad</option>' + 
'<option value="CL">Chile</option>' + 
'<option value="CN">China</option>' + 
'<option value="CX">Christmas Island</option>' + 
'<option value="CC">Cocos (Keeling) Islands</option>' + 
'<option value="CO">Colombia</option>' + 
'<option value="KM">Comoros</option>' + 
'<option value="CG">Congo</option>' + 
'<option value="CD">Democratic Republic of the Congo</option>' + 
'<option value="CK">Cook Islands</option>' + 
'<option value="CR">Costa Rica</option>' + 
'<option value="CI">Cote d\'Ivoire</option>' + 
'<option value="HR">Croatia</option>' + 
'<option value="CU">Cuba</option>' + 
'<option value="CW">Curacao</option>' + 
'<option value="CY">Cyprus</option>' + 
'<option value="CZ">Czech Republic</option>' + 
'<option value="DK">Denmark</option>' + 
'<option value="DJ">Djibouti</option>' + 
'<option value="DM">Dominica</option>' + 
'<option value="DO">Dominican Republic</option>' + 
'<option value="EC">Ecuador</option>' + 
'<option value="EG">Egypt</option>' + 
'<option value="SV">El Salvador</option>' + 
'<option value="GQ">Equatorial Guinea</option>' + 
'<option value="ER">Eritrea</option>' + 
'<option value="EE">Estonia</option>' + 
'<option value="SZ">Eswatini</option>' + 
'<option value="ET">Ethiopia</option>' + 
'<option value="FK">Falkland Islands (Malvinas)</option>' + 
'<option value="FO">Faroe Islands</option>' + 
'<option value="FJ">Fiji</option>' + 
'<option value="FI">Finland</option>' + 
'<option value="FR">France</option>' + 
'<option value="GF">French Guiana</option>' + 
'<option value="PF">French Polynesia</option>' + 
'<option value="TF">French Southern Territories</option>' + 
'<option value="GA">Gabon</option>' + 
'<option value="GM">Gambia</option>' + 
'<option value="GE">Georgia</option>' + 
'<option value="DE">Germany</option>' + 
'<option value="GH">Ghana</option>' + 
'<option value="GI">Gibraltar</option>' + 
'<option value="GR">Greece</option>' + 
'<option value="GL">Greenland</option>' + 
'<option value="GD">Grenada</option>' + 
'<option value="GP">Guadeloupe</option>' + 
'<option value="GU">Guam</option>' + 
'<option value="GT">Guatemala</option>' + 
'<option value="GG">Guernsey</option>' + 
'<option value="GN">Guinea</option>' + 
'<option value="GW">Guinea-Bissau</option>' + 
'<option value="GY">Guyana</option>' + 
'<option value="HT">Haiti</option>' + 
'<option value="HM">Heard Island</option>' + 
'<option value="HN">Honduras</option>' + 
'<option value="HK">Hong Kong</option>' + 
'<option value="HU">Hungary</option>' + 
'<option value="IS">Iceland</option>' + 
'<option value="IN">India</option>' + 
'<option value="ID">Indonesia</option>' + 
'<option value="IR">Islamic Republic of Iran</option>' + 
'<option value="IQ">Iraq</option>' + 
'<option value="IE">Ireland</option>' + 
'<option value="IM">Isle of Man</option>' + 
'<option value="IL">Israel</option>' + 
'<option value="IT">Italy</option>' + 
'<option value="JM">Jamaica</option>' + 
'<option value="JP">Japan</option>' + 
'<option value="JE">Jersey</option>' + 
'<option value="JO">Jordan</option>' + 
'<option value="KZ">Kazakhstan</option>' + 
'<option value="KE">Kenya</option>' + 
'<option value="KI">Kiribati</option>' + 
'<option value="KP">Democratic People\'s Republic of Korea</option>' + 
'<option value="KR">Republic of Korea</option>' + 
'<option value="KW">Kuwait</option>' + 
'<option value="KG">Kyrgyzstan</option>' + 
'<option value="LA">Lao People\'s Democratic Republic</option>' + 
'<option value="LV">Latvia</option>' + 
'<option value="LB">Lebanon</option>' + 
'<option value="LS">Lesotho</option>' + 
'<option value="LR">Liberia</option>' + 
'<option value="LY">Libya</option>' + 
'<option value="LI">Liechtenstein</option>' + 
'<option value="LT">Lithuania</option>' + 
'<option value="LU">Luxembourg</option>' + 
'<option value="MO">Macao</option>' + 
'<option value="MK">Macedonia</option>' + 
'<option value="MG">Madagascar</option>' + 
'<option value="MW">Malawi</option>' + 
'<option value="MY">Malaysia</option>' + 
'<option value="MV">Maldives</option>' + 
'<option value="ML">Mali</option>' + 
'<option value="MT">Malta</option>' + 
'<option value="MH">Marshall Islands</option>' + 
'<option value="MQ">Martinique</option>' + 
'<option value="MR">Mauritania</option>' + 
'<option value="MU">Mauritius</option>' + 
'<option value="YT">Mayotte</option>' + 
'<option value="MX">Mexico</option>' + 
'<option value="FM">Federated States of Micronesia</option>' + 
'<option value="MD">Republic of Moldova</option>' + 
'<option value="MC">Monaco</option>' + 
'<option value="MN">Mongolia</option>' + 
'<option value="ME">Montenegro</option>' + 
'<option value="MS">Montserrat</option>' + 
'<option value="MA">Morocco</option>' + 
'<option value="MZ">Mozambique</option>' + 
'<option value="MM">Myanmar</option>' + 
'<option value="NA">Namibia</option>' + 
'<option value="NR">Nauru</option>' + 
'<option value="NP">Nepal</option>' + 
'<option value="NL">Netherlands</option>' + 
'<option value="NC">New Caledonia</option>' + 
'<option value="NZ">New Zealand</option>' + 
'<option value="NI">Nicaragua</option>' + 
'<option value="NE">Niger</option>' + 
'<option value="NG">Nigeria</option>' + 
'<option value="NU">Niue</option>' + 
'<option value="NF">Norfolk Island</option>' + 
'<option value="MP">Northern Mariana Islands</option>' + 
'<option value="NO">Norway</option>' + 
'<option value="OM">Oman</option>' + 
'<option value="PK">Pakistan</option>' + 
'<option value="PW">Palau</option>' + 
'<option value="PS">State of Palestine</option>' + 
'<option value="PA">Panama</option>' + 
'<option value="PG">Papua New Guinea</option>' + 
'<option value="PY">Paraguay</option>' + 
'<option value="PE">Peru</option>' + 
'<option value="PH">Philippines</option>' + 
'<option value="PN">Pitcairn</option>' + 
'<option value="PL">Poland</option>' + 
'<option value="PT">Portugal</option>' + 
'<option value="PR">Puerto Rico</option>' + 
'<option value="QA">Qatar</option>' + 
'<option value="RE">Reunion</option>' + 
'<option value="RO">Romania</option>' + 
'<option value="RU">Russian Federation</option>' + 
'<option value="RW">Rwanda</option>' + 
'<option value="BL">Saint Barthelemy</option>' + 
'<option value="SH">Ascension and Tristan da Cunha Saint Helena</option>' + 
'<option value="KN">Saint Kitts and Nevis</option>' + 
'<option value="LC">Saint Lucia</option>' + 
'<option value="MF">Saint Martin (French part)</option>' + 
'<option value="PM">Saint Pierre and Miquelon</option>' + 
'<option value="VC">Saint Vincent and the Grenadines</option>' + 
'<option value="WS">Samoa</option>' + 
'<option value="SM">San Marino</option>' + 
'<option value="ST">Sao Tome and Principe</option>' + 
'<option value="SA">Saudi Arabia</option>' + 
'<option value="SN">Senegal</option>' + 
'<option value="RS">Serbia</option>' + 
'<option value="SC">Seychelles</option>' + 
'<option value="SL">Sierra Leone</option>' + 
'<option value="SG">Singapore</option>' + 
'<option value="SX">Sint Maarten (Dutch part)</option>' + 
'<option value="SK">Slovakia</option>' + 
'<option value="SI">Slovenia</option>' + 
'<option value="SB">Solomon Islands</option>' + 
'<option value="SO">Somalia</option>' + 
'<option value="ZA">South Africa</option>' + 
'<option value="GS">South Georgia</option>' + 
'<option value="SS">South Sudan</option>' + 
'<option value="ES">Spain</option>' + 
'<option value="LK">Sri Lanka</option>' + 
'<option value="SD">Sudan</option>' + 
'<option value="SR">Suriname</option>' + 
'<option value="SJ">Svalbard and Jan Mayen</option>' + 
'<option value="SE">Sweden</option>' + 
'<option value="CH">Switzerland</option>' + 
'<option value="SY">Syrian Arab Republic</option>' + 
'<option value="TW">Taiwan</option>' + 
'<option value="TJ">Tajikistan</option>' + 
'<option value="TZ">United Republic of Tanzania</option>' + 
'<option value="TH">Thailand</option>' + 
'<option value="TL">Timor-Leste</option>' + 
'<option value="TG">Togo</option>' + 
'<option value="TK">Tokelau</option>' + 
'<option value="TO">Tonga</option>' + 
'<option value="TT">Trinidad and Tobago</option>' + 
'<option value="TN">Tunisia</option>' + 
'<option value="TR">Turkey</option>' + 
'<option value="TM">Turkmenistan</option>' + 
'<option value="TC">Turks and Caicos Islands</option>' + 
'<option value="TV">Tuvalu</option>' + 
'<option value="UG">Uganda</option>' + 
'<option value="UA">Ukraine</option>' + 
'<option value="AE">United Arab Emirates</option>' + 
'<option value="GB">United Kingdom</option>' + 
'<option value="US" selected>United States</option>' + 
'<option value="UM">United States Minor Outlying Islands</option>' + 
'<option value="UY">Uruguay</option>' + 
'<option value="UZ">Uzbekistan</option>' + 
'<option value="VU">Vanuatu</option>' + 
'<option value="VA">Vatican City</option>' + 
'<option value="VE">Venezuela</option>' + 
'<option value="VN">Viet Nam</option>' + 
'<option value="VG">British Virgin Islands</option>' + 
'<option value="VI">U.S. Virgin Islands</option>' + 
'<option value="WF">Wallis and Futuna</option>' + 
'<option value="EH">Western Sahara</option>' + 
'<option value="YE">Yemen</option>' + 
'<option value="ZM">Zambia</option>' + 
'<option value="ZW">Zimbabwe</option>' + 
'</select>' + 
'</div>' + 
'<div class="field  street-address required" >' + 
'<label for="street-address"><span class="label">Address</span><span class="required-star">*</span></label>' + 
'<textarea id="street-address" name="street-address" class="required"></textarea>' + 
'</div>' + 
'<div class="field text city required" >' + 
'<label for="city"><span class="label">City</span><span class="required-star">*</span></label>' + 
'<input id="city" name="city" class="required" type="text" data-us-label="City" data-bm-label="Parish"></input>' + 
'</div>' + 
'<div class="field  state required" >' + 
'<label for="state">State<span class="required-star">*</span></label>' + 
'<select id="state" name="state" class="required"><option value=""></option>' + 
'<option value="AL">Alabama</option>' + 
'<option value="AK">Alaska</option>' + 
'<option value="AS">American Samoa</option>' + 
'<option value="AZ">Arizona</option>' + 
'<option value="AR">Arkansas</option>' + 
'<option value="AE">Armed Forces Africa, Canada, Europe, Middle East</option>' + 
'<option value="AA">Armed Forces Americas (except Canada)</option>' + 
'<option value="AP">Armed Forces Pacific</option>' + 
'<option value="CA">California</option>' + 
'<option value="CO">Colorado</option>' + 
'<option value="CT">Connecticut</option>' + 
'<option value="DE">Delaware</option>' + 
'<option value="DC">District of Columbia</option>' + 
'<option value="FL">Florida</option>' + 
'<option value="GA">Georgia</option>' + 
'<option value="GU">Guam</option>' + 
'<option value="HI">Hawaii</option>' + 
'<option value="ID">Idaho</option>' + 
'<option value="IL">Illinois</option>' + 
'<option value="IN">Indiana</option>' + 
'<option value="IA">Iowa</option>' + 
'<option value="KS">Kansas</option>' + 
'<option value="KY">Kentucky</option>' + 
'<option value="LA">Louisiana</option>' + 
'<option value="ME">Maine</option>' + 
'<option value="MD">Maryland</option>' + 
'<option value="MA">Massachusetts</option>' + 
'<option value="MI">Michigan</option>' + 
'<option value="MN">Minnesota</option>' + 
'<option value="MS">Mississippi</option>' + 
'<option value="MO">Missouri</option>' + 
'<option value="MT">Montana</option>' + 
'<option value="NE">Nebraska</option>' + 
'<option value="NV">Nevada</option>' + 
'<option value="NH">New Hampshire</option>' + 
'<option value="NJ">New Jersey</option>' + 
'<option value="NM">New Mexico</option>' + 
'<option value="NY">New York</option>' + 
'<option value="NC">North Carolina</option>' + 
'<option value="ND">North Dakota</option>' + 
'<option value="OH">Ohio</option>' + 
'<option value="OK">Oklahoma</option>' + 
'<option value="OR">Oregon</option>' + 
'<option value="PA">Pennsylvania</option>' + 
'<option value="PR">Puerto Rico</option>' + 
'<option value="RI">Rhode Island</option>' + 
'<option value="SC">South Carolina</option>' + 
'<option value="SD">South Dakota</option>' + 
'<option value="TN">Tennessee</option>' + 
'<option value="TX">Texas</option>' + 
'<option value="VI">US Virgin Islands</option>' + 
'<option value="UT">Utah</option>' + 
'<option value="VT">Vermont</option>' + 
'<option value="VA">Virginia</option>' + 
'<option value="WA">Washington</option>' + 
'<option value="WV">West Virginia</option>' + 
'<option value="WI">Wisconsin</option>' + 
'<option value="WY">Wyoming</option>' + 
'</select>' + 
'</div>' + 
'<div class="field  province required" style="display: none">' + 
'<label for="province">Province<span class="required-star">*</span></label>' + 
'<select id="province" name="province" class="required"><option value=""></option>' + 
'<option value="AB">Alberta</option>' + 
'<option value="BC">British Columbia</option>' + 
'<option value="MB">Manitoba</option>' + 
'<option value="NB">New Brunswick</option>' + 
'<option value="NL">Newfoundland and Labrador</option>' + 
'<option value="NT">Northwest Territories</option>' + 
'<option value="NS">Nova Scotia</option>' + 
'<option value="NU">Nunavut</option>' + 
'<option value="ON">Ontario</option>' + 
'<option value="PE">Prince Edward Island</option>' + 
'<option value="QC">Quebec</option>' + 
'<option value="SK">Saskatchewan</option>' + 
'<option value="YT">Yukon Territory</option>' + 
'</select>' + 
'</div>' + 
'<div class="field number zip-code required" >' + 
'<label for="zip-code"><span class="label">ZIP Code</span><span class="required-star">*</span></label>' + 
'<input id="zip-code" name="zip-code" class="zipcodeUS required" type="number" minlength="5" maxlength="10"></input>' + 
'</div>' + 
'<div class="field text postal-code required" style="display: none">' + 
'<label for="postal-code"><span class="label">Postal Code</span><span class="required-star">*</span></label>' + 
'<input id="postal-code" name="postal-code" class="required" type="text"></input>' + 
'</div>' + 
'' + 
'</div>' + 
'    ' + 
'    <div class="section comment">' + 
'      <div class="field text comment" >' + 
'<label for="comment"><span class="label">Comments</span></label>' + 
'<textarea id="comment" name="comment" type="text" value="Comments"></textarea>' + 
'</div>' + 
'' + 
'</div>' + 
'    <div class="section consent hidden">' + 
'      <div class="field checkbox consent-all" >' + 
'<label for="consent-all"><input id="consent-all" name="consent-all" type="checkbox" maxlength="255"></input><span class="label">I would like to receive or continue receiving updates from Specially Adapted Resource Clubs</span></label>' + 
'</div>' + 
'<div class="field checkbox consent-email" style="display: none">' + 
'<label for="consent-email"><input id="consent-email" name="consent-email" type="checkbox" checked="checked" maxlength="255"></input><span class="label">by email</span></label>' + 
'</div>' + 
'<div class="field checkbox consent-mail" style="display: none">' + 
'<label for="consent-mail"><input id="consent-mail" name="consent-mail" type="checkbox" checked="checked" maxlength="255"></input><span class="label">by postal mail</span></label>' + 
'</div>' + 
'<div class="field checkbox consent-phone" style="display: none">' + 
'<label for="consent-phone"><input id="consent-phone" name="consent-phone" type="checkbox" checked="checked" maxlength="255"></input><span class="label">by phone</span></label>' + 
'</div>' + 
'' + 
'</div>' + 
'    <div class="section captcha">' + 
'      <label id=\'noCaptchaResponseError\' class=\'error noCaptchaResponseError\' style=\'display: none\'>You must fill out the CAPTCHA</label><div id="captcha4947968"></div>' + 
'' + 
'</div>' + 
'    <div class="section payment">' + 
'      <h3>Payment Information</h3>' + 
'      <div class="field radio DebitCard required" >' + 
'<label for="DebitCard"><input id="DebitCard" name="payment-type" class="required" type="radio" maxlength="255"></input><span class="label">Debit Card</span></label>' + 
'</div>' + 
'<div class="field radio CreditCard required" >' + 
'<label for="CreditCard"><input id="CreditCard" name="payment-type" class="required" type="radio" maxlength="255"></input><span class="label">Credit Card</span></label>' + 
'</div>' + 
'<div class="field radio Savings required" >' + 
'<label for="Savings"><input id="Savings" name="payment-type" class="required" type="radio" maxlength="255"></input><span class="label">Savings</span></label>' + 
'</div>' + 
'<div class="field radio Checking required" >' + 
'<label for="Checking"><input id="Checking" name="payment-type" class="required" type="radio" maxlength="255"></input><span class="label">Checking</span></label>' + 
'</div>' + 
'<div class="field radio PayPalVenmo required" >' + 
'<label for="PayPalVenmo"><input id="PayPalVenmo" name="payment-type" class="required" type="radio" maxlength="255"></input><span class="label">PayPal or Venmo</span></label>' + 
'</div>' + 
'<div class="field number routingNumber required" style="display: none">' + 
'<label for="routingNumber"><span class="label">Routing Number</span><span class="required-star">*</span></label>' + 
'<input id="routingNumber" name="routing-number" class="required" type="number" maxlength="255"></input>' + 
'</div>' + 
'<div class="field number accountNumber required" style="display: none">' + 
'<label for="accountNumber"><span class="label">Account Number</span><span class="required-star">*</span></label>' + 
'<input id="accountNumber" name="account-number" class="required" type="number" maxlength="255"></input>' + 
'</div>' + 
'<div class="field text payment required" id="stripe-cc-fields">' + 
'                                  <label for="card-element">' + 
'                                    <span class="label">Credit or debit card</span>' + 
'                                    <span class="required-star">*</span>' + 
'                                  </label>' + 
'                                  <div id="card-element"></div>' + 
'                                  <div id="card-errors" role="alert"></div>' + 
'                                </div>' + 
'' + 
'</div>' + 
'    ' + 
'    <p id="preview-text" style="font-style:italic;font-size:13px;font-family:Prompt, sans-serif;letter-spacing:0.25px;display:none;">More payment information appears on your live form. For a complete preview, go to the forms list and select View Hosted Form.</p>' + 
'    <div class="btn-group">' + 
'      <input class="btn btn-submit btn-submit-donation" type="submit" value="Donate Now" id="express-submit" disabled="true" />' + 
'    </div>' + 
'    <div id="paypal-button-container"></div>' + 
'  </form>' + 
'</div>' + 
'<div id="donation-processing-container" style="display: none">' + 
'  <h2>Processing...</h2><p>Your transaction is being processed. Please do not close your browser or leave this page.</p>' + 
'</div>' + 
'' + 
'' +  '';var successHtml4947968 = '<div class=\'donation-success\'>' +
                                                       '  <h2>Thank You for Your Donation!</h2>' +
                                                       '  <p>Your generous gift has been processed. We truly appreciate your continued support.</p>' + 
                                                        '   ' + 
                                                        '</div>';( function($) {if (Bloomerang.useDonationId('4947968')) { 
                                Bloomerang.useProcessor('607233', 'StripeExpress', 'pk_live_iZYXFefCkt380zu63aqUIo7y');
                            } else {
                                html4947968 = '<p style="color: red">Only one donation or event registration form can be used on each page.</p>';
                            }if (jQuery('#bloomerangForm4947968').length) {
                        
                    if (window.ActiveXObject) { // they are using IE < 11, which doesn't support TLS 1.1
                        html4947968 = '<p style="color: red">Your browser does not support the minimum security requirements for keeping your Credit Card information safe when processing payments. Please upgrade your browser or download the latest version of' + 
                        ' <a target=\'_blank\' href=\'https://www.google.com/chrome/browser/desktop/\'>Chrome</a> or <a target=\'_blank\' href=\'https://www.mozilla.org/en-US/firefox/new/\'>Firefox</a>.</p>';
                    }
                        jQuery('#bloomerangForm4947968').after(html4947968);
                        
                         Bloomerang.Util.requireStripe(function() {
                              Bloomerang.Util.Stripe = Stripe('pk_live_iZYXFefCkt380zu63aqUIo7y');

                              Bloomerang.useKey('pub_0671a94c-634e-11f0-9fbb-06179723032d');

                              // Means we didn't set the client secret for self-hosted forms so we create one!
                              if(!Bloomerang.StripePaymentElement) {
                                Bloomerang.Util.createInitialIntentForSelfHosted(false);
                              }
                              else {
                                Bloomerang.Util.mountStripePaymentElements(false);
                              }

                              jQuery(".donation-form #express-submit").val("Donate Now");
                              jQuery(".registration-form #express-submit").val("Register Now");
                              jQuery(".membership-form #express-submit").val("Start Membership â€¢ $0.00");
                              jQuery("#express-submit").attr("disabled", false);
                              Bloomerang.donationFormStripeOnBehalfOfFlag = true; 
                              Bloomerang.StripeAccountId = 'acct_1SGiJ0HmkE8BgkVQ';
                            });
                        
                        Bloomerang.Util.requirePayPal('AbhrJjDZYrv1QNO_ZLVf6XpZky3SZjtvREbPF07KssBteJ-TKfH23tl5cm0KwXGme7ayVHOK7HGMd4q-', function() {
                         Bloomerang.Data.PayPal.IsPayPalVenmoEnabled = true;
                         Bloomerang.Data.PayPal.IsPayPalPaymentMethodVaultingEnabled = false;
                         Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled = false;
                         Bloomerang.Util.mountPayPalVenmoElements();
                         Bloomerang.Data.PayPal.ProcessorAccountId = 'KGVJ4TRNLC63L';
                         Bloomerang.Data.PayPal.PartnerFeeId = 'DGXFVX3EJBNXU';
                       });
                        
                    };
                    if (Bloomerang.paymentFormLoaded) {
                                            return false;
                                        }
                                        Bloomerang.paymentFormLoaded = true;
                      
                        Bloomerang.reCaptchaV3SiteKey = '6LeH9PUrAAAAAN0wv9VTVahiByfF9sGDQglOBEYK';
                        Bloomerang.gRecaptchaV3Threshold = 0.5;

                        window.captchaLoadCallback = function() {
                            Bloomerang.gRecaptchaLoaded = true;
                        };
                        
                        window.captchaV3LoadCallback = function() {
                            Bloomerang.gRecaptchaV3Loaded = true;
                        };

                        if(Bloomerang.donationFormReCaptchaV3SelfHostedFlag === undefined) {
                            function success (result) {
                                Bloomerang.donationFormReCaptchaV3SelfHostedFlag = result.DonationFormReCaptchaV3SelfHostedFlag;
                                initializeCaptcha();
                            }
                                
                            function failure (result) {
                                Bloomerang.donationFormReCaptchaV3SelfHostedFlag = false;
                                initializeCaptcha();
                            } 

                            Bloomerang.Api._post('v1/ReCaptchaV3SelfHostedFlag', {}, success, failure);
                        } else {
                            initializeCaptcha();
                        }

                        async function getRecaptchaV3Token() {
                              const token = await new Promise((resolve, reject) => {
                                 grecaptcha.ready(function() {
                                    grecaptcha.execute(Bloomerang.reCaptchaV3SiteKey, {action: 'submit'}).then(function(token) {
                                       resolve(token);
                                     });
                                  });
                                });

                                return token;
                        }
                        
                        function initializeCaptcha() {
                            Bloomerang.Util.load('https://www.google.com/recaptcha/api.js?onload=captchaLoadCallback&render=explicit',
                                function() { return Bloomerang.gRecaptchaLoaded; },
                                function() {
                                    jQuery('.section.captcha').removeAttr('style');
                                    jQuery('form.donation-form').data('captcha-id', grecaptcha.render('captcha4947968', { 'sitekey' : '6LdM9EsrAAAAAGOAM46W9nBGf3WNXrN1bZ6PQWed' }));
                                    
                                    if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm && Bloomerang.isDonationForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey && Bloomerang.isDonationForm)) {
                                        jQuery('.section.captcha').attr('style', 'display: none');
                                    }
                                },
                                true,
                                true);
                            
                            if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm && Bloomerang.isDonationForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.isDonationForm && Bloomerang.reCaptchaV3SiteKey)) {
                                 Bloomerang.Util.load(`https://www.google.com/recaptcha/api.js?onload=captchaV3LoadCallback&render=${Bloomerang.reCaptchaV3SiteKey}`,
                                    function() { return Bloomerang.gRecaptchaV3Loaded; },
                                    function() {
                                        grecaptcha.ready(function() {
                                          grecaptcha.execute(Bloomerang.reCaptchaV3SiteKey, {action: 'submit'}).then(function(token) {
                                              async function success (result) {
                                                if(parseFloat(result.Score) < Bloomerang.gRecaptchaV3Threshold) {
                                                    Bloomerang.isForcePuzzle = true;
                                                    jQuery('.section.captcha').attr('style', 'display: block');
                                                } else {

                                                    const initialRecaptchaV3Token = await getRecaptchaV3Token();

                                                     // Append to the form data container to be included when submitting the form on bloomerangV2.js
                                                     Bloomerang.captchaResponseV3(initialRecaptchaV3Token);

                                                     setInterval(async ()=> {
                                                         const recaptchaV3Token = await getRecaptchaV3Token();

                                                        // Append to the form data container to be included when submitting the form on bloomerangV2.js
                                                        Bloomerang.captchaResponseV3(recaptchaV3Token);
                                                     }, 80000);
                                                }
                                               }
                                                
                                               function failure (result) {
                                                Bloomerang.isForcePuzzle = true;
                                                jQuery('.section.captcha').attr('style', 'display: block');
                                               }
                                                
                                               var data = {
                                                  token: token,
                                                  isSelfHosted: !Bloomerang.isBloomerangHostedForm
                                               };
                                                
                                                Bloomerang.Api._post('v1/ReCaptchaV3', data, success, failure);
                                          });
                                        });
                                    },
                                    true,
                                    true);
                               }
                           }
                            
                    
                    Bloomerang.transactionFee = 0.3; 
                    Bloomerang.transactionFeeRate = 0.032; 
                    Bloomerang.transactionFeeEft = 0.3; 
                    Bloomerang.transactionFeeRateEft = 0.018;
                    Bloomerang.transactionFeePayPal = 0.49; 
                    Bloomerang.transactionFeeRatePayPal = 0.032; 
                    
                    Bloomerang.useKey('pub_0671a94c-634e-11f0-9fbb-06179723032d');

        if (typeof isPreviewMode !== 'undefined' && isPreviewMode) {
          document.querySelector('#preview-text').style.display = 'block';
        }
        
        Bloomerang.isDonationForm=true;
        Bloomerang.Util.getDonationAmount = function() {
          return Number(accounting.unformat(jQuery(".donation-form .section.donation input[name='donation-level']:checked").val() || jQuery(".donation-form #donation-amount").val()));
        };

        // Register proper callbacks for various stages/outcomes of submission
        Bloomerang.Widget.Donation.OnSubmit = function (args) {
            jQuery(".btn-submit-donation").val("Donating...").prop("disabled", true).addClass("disabled");
            var val = function (selector) { return jQuery(selector).val(); };
            var country = val(".donation-form #country");
            var state = Bloomerang.Util.getCorrectState(country, val(".donation-form #state"), val(".donation-form #province"));
            var zipCode = Bloomerang.Util.getCorrectZipCode(country, val(".donation-form #zip-code"), val(".donation-form #postal-code"));
            Bloomerang.Account
                    .individual()
                    .firstName(val(".donation-form #first-name"))
                    .middleName(val(".donation-form #middle-name"))
                    .lastName(val(".donation-form #last-name"))
                    .homeAddress(val(".donation-form #street-address"),
                                 val(".donation-form #city"),
                                 state,
                                 zipCode,
                                 country)
                    .homeEmail(val(".donation-form #email-address"))
                    .homePhone(val(".donation-form #phone-number"))
                    .applyDonationCustomFields();

            if (jQuery(".donation-form #consent-all").prop("checked")) {
              Bloomerang.Account.optedInStatus(jQuery(".donation-form #consent-email").prop("checked"),
                                               jQuery(".donation-form #consent-mail").prop("checked"),
                                               jQuery(".donation-form #consent-phone").prop("checked"));
            }

            var amount = Bloomerang.Util.getDonationAmount() + Bloomerang.Util.getDonationTrueImpactAmount();
            if (jQuery(".donation-form #recurring").prop("checked")) {
                Bloomerang.RecurringDonation
                        .amount(amount)
                        .fundId(val(".donation-form #fund"))
                        .note(val(".donation-form #comment"))
                        .frequency(val(".donation-form #frequency") || "Monthly")
                        .startDate(val(".donation-form #start-date"))
                        .applyDonationCustomFields();

                // Need to do a null-check here because they might have a cached version of Bloomerang-v2.js
                if (Bloomerang.RecurringDonation.trueImpactEnabled && Bloomerang.RecurringDonation.trueImpactUsed) {
                  Bloomerang.RecurringDonation
                        .trueImpactEnabled(jQuery(".donation-form .true-impact .fee-amount").length > 0)
                        .trueImpactUsed(jQuery(".donation-form .true-impact input:checked").length > 0);
                }
            } else {
                Bloomerang.Donation
                        .amount(amount)
                        .fundId(val(".donation-form #fund"))
                        .note(val(".donation-form #comment"))
                        .applyDonationCustomFields();

                // Need to do a null-check here because they might have a cached version of Bloomerang-v2.js
                if (Bloomerang.Donation.trueImpactEnabled && Bloomerang.Donation.trueImpactUsed) {
                  Bloomerang.Donation
                        .trueImpactEnabled(jQuery(".donation-form .true-impact .fee-amount").length > 0)
                        .trueImpactUsed(jQuery(".donation-form .true-impact input:checked").length > 0);
                }
            }

            if (jQuery("#donation-form #Checking").is(":checked") ||
                jQuery("#donation-form #Savings").is(":checked")) {
              if (Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled === true) {
                Bloomerang.Eft
                  .accountNumber(val(".donation-form #accountNumber"))
                  .routingNumber(val(".donation-form #routingNumber"))
                  .type(jQuery("#donation-form .section.movedpayment input[type='radio']:checked").attr("id"));
              } else {
                Bloomerang.Eft
                  .accountNumber(val(".donation-form #accountNumber"))
                  .routingNumber(val(".donation-form #routingNumber"))
                  .type(jQuery("#donation-form .section.payment input[type='radio']:checked").attr("id"));
              }
            } else if (jQuery("#PayPalVenmo").is(":checked") || 
                jQuery("#PayPal").is(":checked") ||
                jQuery("#Venmo").is(":checked")) {
              if (Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled === true) {
                Bloomerang.Donation
                  .type(jQuery("#donation-form .section.movedpayment input[type='radio']:checked").attr("id"));
              } else {
                Bloomerang.Donation
                  .type(jQuery("#donation-form .section.payment input[type='radio']:checked").attr("id"));
              }
            }
            
        };
        Bloomerang.ValidateDonationFormCaptcha = function() {
           if (typeof(grecaptcha) !== "undefined" && (jQuery("#captcha" + Bloomerang.Data.WidgetIds.Donation).children().length || ((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey)))) {
                var captchaResponse = grecaptcha.getResponse(jQuery(".donation-form").data("captcha-id"));
                if (captchaResponse) {
                    jQuery(".donation-form .noCaptchaResponseError").hide();
                    Bloomerang.captchaResponse(captchaResponse);
                    return true;
                } else {
                    jQuery(".donation-form .noCaptchaResponseError").show();
                    return false;
                }
            } else return true;
        };
        Bloomerang.scrollToElement = function(element) {
            var distance = 100;
            var offset = element.offset().top;
            var offsetTop = offset > distance ? offset - distance : offset;
                jQuery('html, body').animate({ scrollTop : offsetTop}, 500);
        };
        Bloomerang.Api.OnSuccess = Bloomerang.Widget.Donation.OnSuccess = function (response) {
            jQuery("#donation-processing-container").hide();
            var formContainer = jQuery("#donation-form-container");
            formContainer.show();
            formContainer.html(successHtml4947968);
            Bloomerang.scrollToElement(formContainer);
        };
        Bloomerang.Api.OnError = Bloomerang.Widget.Donation.OnError = function (response) {
            jQuery(".btn-submit-donation").prop("disabled", false).removeClass("disabled");
            Bloomerang.Util.updateDonateButtonText();
            jQuery("#donation-form-container .errors").removeClass("hidden").html(response.Message);
            jQuery("#donation-processing-container").hide();
            jQuery("#donation-form-container").show();
            Bloomerang.scrollToElement(jQuery("#donation-form-container .errors"));
            Bloomerang.cancelFinancialSubmission(jQuery("#donation-form"));
            if (typeof(SpreedlyExpress) !== 'undefined') { 
              SpreedlyExpress.unload();
              Bloomerang.initSpreedly();
            }
            if (typeof(grecaptcha) !== "undefined" && jQuery("#captcha" + Bloomerang.Data.WidgetIds.Donation).children().length) {
              grecaptcha.reset(jQuery(".donation-form").data("captcha-id"));
            }
        };
        
        Bloomerang.Util.applyDonationCustomFields = function (obj, type) {
        
            // Clear any fields from a previous failed submission
            obj.clearCustomFields();
        
            // Apply all <input> (not multiselect), <select> and <textarea> fields
            jQuery(".donation-form .section.custom-fields :input:not(a > input, select)[id*=" + type + "]").each(function() {
                if (jQuery(this).val().hasValue()) {
                    obj.customFreeformField(jQuery(this).attr("id").toUntypedValue(), jQuery(this).val());
                }
            });
            
            // Apply all <select> fields
            jQuery(".donation-form .section.custom-fields select[id*=" + type + "]").each(function() {
                if (jQuery(this).val().hasValue()) {
                    obj.customPickField(jQuery(this).attr("id").toUntypedValue(), jQuery(this).val());
                }
            });
                
            // Apply all multiselect fields
            jQuery(".donation-form .section.custom-fields .checkboxes[id*=" + type + "]").each(function() {
                obj.customPickField(jQuery(this).attr("id").toUntypedValue(),
                jQuery.map(jQuery(this).children(".checkbox.selected"), function(v) { return jQuery(v).attr("data-id"); }));
            });
        };
        
        String.prototype.hasValue = function() {
            return (this && jQuery.trim(this)); //IE8 doesn't have a native trim function
        };
        
        Bloomerang.Account.applyDonationCustomFields = function () {
            Bloomerang.Util.applyDonationCustomFields(this, "Account");
            return this;
        };
        
        Bloomerang.Donation.applyDonationCustomFields = function () {
            Bloomerang.Util.applyDonationCustomFields(this, "Transaction");
            return this;
        };
        
        Bloomerang.RecurringDonation.applyDonationCustomFields = function () {
            Bloomerang.Util.applyDonationCustomFields(this, "Transaction");
            return this;
        };
        
        String.prototype.toUntypedValue = function() {
            return this.substring(this.indexOf('_') + 1);
        };
        
        Date.prototype.toDateInputValue = function() {
            var local = new Date(this);
            local.setMinutes(this.getMinutes() - this.getTimezoneOffset());
            return (local.getMonth() + 1) + // Add one to the month because it starts at 0
                    "/" + local.getDate() + "/" + local.getFullYear();
        };
        
        jQuery(document).ready(function() {
            jQuery(".donation-form .field.start-date input").val(new Date().toDateInputValue());
            
            jQuery(".donation-form .field.start-date input").blur(function() {
              if(Bloomerang.Data.PayPal.IsPayPalVenmoEnabled && Bloomerang.Data.PayPal.IsPayPalPaymentMethodVaultingEnabled) {
                Bloomerang.Data.PayPal.ButtonsObject.close();
                if(Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled && !jQuery(".donation-form .field.start-date input").valid())
                  return;
                // Future date
                if(new Date(jQuery(".donation-form .field.start-date input").val()) > new Date(new Date().toISOString().split('T')[0])) {
                  if (Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled) {
                    var source = jQuery("#donation-form #Venmo").is(":checked") ? paypal.FUNDING.VENMO : paypal.FUNDING.PAYPAL;
                    Bloomerang.Data.PayPal.ButtonsObject = paypal.Buttons(Bloomerang.Util.paypalButtonsFutureRecurringOptionsWithSource(source));
                  } else {
                    Bloomerang.Data.PayPal.ButtonsObject = paypal.Buttons(Bloomerang.Util.paypalButtonsFutureRecurringOptions());
                  }
                } else {
                  Bloomerang.Data.PayPal.ButtonsObject = paypal.Buttons(Bloomerang.Data.PayPal.ButtonsOptions);
                }
                Bloomerang.Data.PayPal.ButtonsObject.render('#paypal-button-container');
              }
            });
            
            // Re-render paypal buttons in case where user was initially doing a future recurring donation
            // then decided to uncheck the recurring donation checkbox
            jQuery(".donation-form #recurring").change(function() {
              if(Bloomerang.Data.PayPal.IsPayPalVenmoEnabled && Bloomerang.Data.PayPal.IsPayPalPaymentMethodVaultingEnabled) {
                Bloomerang.Data.PayPal.ButtonsObject.close();
                // Start Date is set to later than today
                if(this.checked && jQuery(".donation-form .field.start-date input").val() && new Date(jQuery(".donation-form .field.start-date input").val()) > new Date(new Date().toISOString().split('T')[0])) {
                  if (Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled) {
                    var source = jQuery("#donation-form #Venmo").is(":checked") ? paypal.FUNDING.VENMO : paypal.FUNDING.PAYPAL;
                    Bloomerang.Data.PayPal.ButtonsObject = paypal.Buttons(Bloomerang.Util.paypalButtonsFutureRecurringOptionsWithSource(source));
                  } else {
                    Bloomerang.Data.PayPal.ButtonsObject = paypal.Buttons(Bloomerang.Util.paypalButtonsFutureRecurringOptions());
                  }
                } else {
                  if (Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled) {
                    var source = jQuery("#donation-form #Venmo").is(":checked") ? paypal.FUNDING.VENMO : paypal.FUNDING.PAYPAL;
                    Bloomerang.Data.PayPal.ButtonsObject = paypal.Buttons(Bloomerang.Util.paypalButtonsVaultingOptionsWithSource(source));
                  } else {
                    Bloomerang.Data.PayPal.ButtonsObject = paypal.Buttons(Bloomerang.Util.paypalButtonsVaultingOptions());
                  }
                }
                Bloomerang.Data.PayPal.ButtonsObject.render('#paypal-button-container');
              }
            });
        });
        
        // Hide recurring donation options if recurring donation box is unchecked
        jQuery(".donation-form .field.recurring").change(function() { 
            jQuery(".donation-form .field.recurring").siblings().not(".recurring-paypal-venmo-label-info").each(function(i, e) { 
                jQuery(e).toggle();
            }); 
        })
        
        // The other-amount field is only equired when the "Other" donation-level is selected
        toggleOtherAmountRequired = function () { 
          jQuery(".donation-form #other-amount").toggleClass("required",
            jQuery(".donation-form #other-option").prop("checked"));
          Bloomerang.Util.calculateDonationTrueImpact();
        };
        jQuery(".donation-form .section.donation input[name='donation-level']").change(function() {
           toggleOtherAmountRequired();
           Bloomerang.Util.updateDonateButtonText();
         });

        if (jQuery(".donation-form .true-impact label").length) {
          jQuery(".donation-form .true-impact label")[0].innerHTML = jQuery(".donation-form .true-impact label")[0].innerHTML.replace("[amount]", "<span class='fee-amount'>$0</span>");
        }
        Bloomerang.Util.calculateDonationTrueImpact = function() {
          if (!jQuery(".donation-form .true-impact .fee-amount").length) { return; }
          // Note that we don't really care about JS floating point math. It's OK if the numbers are a couple cents off.
          var amount = Bloomerang.Util.getDonationAmount();
          if (amount === 0) {  // No donation amount, no impact amount
            jQuery(".donation-form .true-impact .fee-amount").text(accounting.formatMoney(0));
            return 0;
          }

          var impactAmount;

          // If this is a OnePay form, use the transaction fee formula/data to calculate the impactAmount
          if (Bloomerang.Util.isProcessorOnePay()) {
            impactAmount = Bloomerang.Util.calculateTrueImpactForOnePay(amount);
          }

          if (!impactAmount || isNaN(impactAmount)) {
            var isEft = (jQuery("#donation-form #Checking").is(":checked") || jQuery("#donation-form #Savings").is(":checked"));
            var isPayPalVenmo = jQuery("#donation-form #PayPalVenmo").is(":checked");
            var isPayPal = jQuery("#donation-form #PayPal").is(":checked");
            var isVenmo = jQuery("#donation-form #Venmo").is(":checked");
            var isStripeExpress = Bloomerang.Api.ProcessorType === "StripeExpress";

            var feeRate = isEft ? Bloomerang.transactionFeeRateEft : Bloomerang.transactionFeeRate;
            var newTotal = (amount + (isEft ? Bloomerang.transactionFeeEft : Bloomerang.transactionFee)) / (1 - feeRate);
            
            if(isPayPalVenmo || isPayPal || isVenmo){
              var paypalFee = Bloomerang.transactionFeePayPal;
              var paypalPercentage = Bloomerang.transactionFeeRatePayPal;
              newTotal = (amount + paypalFee) / (1 - paypalPercentage);
              impactAmount = Number((Math.floor((newTotal - amount)*100)/100).toFixed(2));
            }
            else{
              impactAmount = isStripeExpress
                ? Number((Math.floor((newTotal - amount)*100)/100).toFixed(2))
                : Number((newTotal - amount).toFixed(2));
            }
          }
          
          jQuery(".donation-form .true-impact .fee-amount").text(accounting.formatMoney(impactAmount));
          return impactAmount;
        };
        Bloomerang.Util.getDonationTrueImpactAmount = function() {
          if (jQuery(".donation-form .true-impact input:checked").length) {
            return Bloomerang.Util.calculateDonationTrueImpact();
          }
          return 0;
        };
        
        Bloomerang.Util.updateDonateButtonText = function() {
            var amount = Bloomerang.Util.getDonationAmount();
            var impactAmount = Bloomerang.Util.getDonationTrueImpactAmount();
            if (Bloomerang.Util.isProcessorOnePay() && Bloomerang.Data.DigitalWallet && (Bloomerang.Data.DigitalWallet === "GooglePay" || Bloomerang.Data.DigitalWallet === "ApplePay")) {
              Bloomerang.Util.sendOnePayTotalAmount((amount + impactAmount)*100);
            }
            jQuery(".btn-submit-donation").val("Donate Now " + accounting.formatMoney(amount + impactAmount));
        };

        // Changing the value of other-amount should change the value of other-option
        jQuery(".donation-form #other-amount").change(function () { 
          jQuery(".donation-form #other-option").val(jQuery(this).val());
          Bloomerang.Util.calculateDonationTrueImpact();
          Bloomerang.Util.updateDonateButtonText();
        });
        
        jQuery(".donation-form #donation-amount").change(function() {
          Bloomerang.Util.calculateDonationTrueImpact();
          Bloomerang.Util.updateDonateButtonText();
        });
        
        // Clicking into the other-amount field should select the other-option
        jQuery(".donation-form #other-amount").click(function() { 
          jQuery(".donation-form #other-option").prop('checked',true);
          toggleOtherAmountRequired();
          Bloomerang.Util.calculateDonationTrueImpact();
        });
        
        jQuery.validator.addMethod("startDateVenmo", function (value, element) {
            return this.optional(element) || !jQuery("#donation-form #Venmo").is(":checked") || value <= new Date().toISOString().split('T')[0];
        }, "Recurring donations processed through Venmo must have the same start date as the day of the transaction.");

        jQuery.validator.addMethod("phoneUS", function(phone_number, element) {
            var digits = phone_number.replace(/\D/g, "");
            return this.optional(element) || digits.length == 7 || digits.length == 10 || digits.length == 11;
        }, "Please specify a valid phone number or use '+' for international.");

        jQuery.validator.addMethod("phoneInternational", function (phone_number, element) {
            return this.optional(element) || /^\+[0-9\-\(\)\s.]+$/i.test(phone_number);
        }, "Please specify a valid phone number.");
        jQuery.validator.classRuleSettings.phoneInternational = { phoneInternational: true };
        
        jQuery.validator.addMethod("zipcodeUS", function (value, element) {
            return this.optional(element) || /\d{5}-\d{4}$|^\d{5}$/.test(value)
        }, "The specified US ZIP Code is invalid");

        jQuery.validator.addMethod("currency", function (value, element, options) {
            return !value ||
                value
                  .replace("$", "")
                  .replace(".", "")
                  .split(",").join("")
                  .match(/^\d+$/g);
        }, "Not a valid currency");

        jQuery.validator.classRuleSettings.currency = { currency: true };
        
        // Validate the other amount, but only if they selected it
        jQuery.validator.addMethod("otherAmount", function(value, element, param) {
          if (jQuery(".donation-form #other-option").prop("checked")) {
            return jQuery.validator.methods.min.bind(this)(value, element, 1) &&
              jQuery.validator.methods.currency(value, element);
          }
          return true;
        }, "Invalid amount");
        
        jQuery.validator.classRuleSettings.otherAmount = { otherAmount: true };

        jQuery.validator.addMethod("number", function (value, element, options) {
          return !value ||
              value
                .replace(".", "")
                .split(",").join("")
                .match(/^\d+$/g);
        }, "Not a valid number");

        jQuery.validator.classRuleSettings.number = { number: true };
        
        jQuery.validator.addMethod("validYear", function (value, element, options) {
            try {
                return (!value || value.match(/^[1-9]\d\d\d$/)) ? true : false;
            }
            catch (e) {
                return false;
            }
        }, function () { return "Must be a 4 digit year"; });

        jQuery.validator.classRuleSettings.validYear = { validYear: true };
        
        // Validate that the donation amount is at least $1
        jQuery.validator.methods.min = function( value, element, param ) {
          if (typeof (accounting) === "undefined") { // rip out $ and ,
              value = ((value + "") || "").replace(/[\$,]/g, "");
          }
          else { // Use accounting.parse, to handle $ and ,
              value = accounting.parse(value);
          }
          return this.optional( element ) || value >= param;
        };
        jQuery.validator.classRuleSettings.minimum1 = { min: 1 };
        jQuery.validator.messages.min = 'Please enter a value of at least {0}.'

        jQuery(".donation-form #country").change(function(event) {
          var element = jQuery(event.target || event.srcElement); // cross-browser event target selection
          var isInternational = (element.val() != "US" && element.val() != "CA" && element.val() != "BM");
          // TODO: Remove this when we have figured out the canada state/province issue
          Bloomerang.Util.addLog("Pre country change: Country=" + element.val() + ", State=" + jQuery(".donation-form #state").val() + ", Province=" + jQuery(".donation-form #province").val() + ", City=" + jQuery(".donation-form #city").val());
          jQuery(".donation-form #state, .donation-form #province").val(""); // clear the state when the country changes
          jQuery(".donation-form .field.city, .donation-form .field.state, .donation-form .field.province, .donation-form .field.zip-code, .donation-form .field.postal-code").toggle(!isInternational);
          jQuery(".donation-form #street-address").toggleClass("international", isInternational);
          if (element.val() == "BM") {
            jQuery(".donation-form .field.city .label").text(jQuery(".donation-form .field.city input").data("bm-label"));
          } else if (element.val() == "US" || element.val() == "CA") {
            jQuery(".donation-form .field.city .label").text(jQuery(".donation-form .field.city input").data("us-label"));
          }
          if (element.val() == "US") {
            jQuery(".donation-form .field.state, .donation-form .field.zip-code").show();
            jQuery(".donation-form .field.province, .donation-form .field.postal-code").hide();
          } else if (element.val() == "CA") {
            jQuery(".donation-form .field.state, .donation-form .field.zip-code").hide();
            jQuery(".donation-form .field.province, .donation-form .field.postal-code").show();
          } else if (element.val() == "BM") {
            jQuery(".donation-form .field.state, .donation-form .field.province, .donation-form .field.zip-code").hide();
            jQuery(".donation-form .field.postal-code").show();
          } else {
            jQuery(".donation-form #city, .donation-form #postal-code, .donation-form #zip-code").val("");
          }
          jQuery(".donation-form .section.consent").toggleClass("hidden", !Bloomerang.Util.isCountryInEurope(element.val()));
          // TODO: Remove this when we have figured out the canada state/province issue
          Bloomerang.Util.addLog("Post country change: Country=" + element.val() + ", State=" + jQuery(".donation-form #state").val() + ", Province=" + jQuery(".donation-form #province").val()+ ", City=" + jQuery(".donation-form #city").val());
        });

        // TODO: Remove this when we have figured out the canada state/province issue
        // We use the focusin function to save the previous value so we can log out the previous and new values on change
        // https://stackoverflow.com/questions/29118178/input-jquery-get-old-value-before-onchange-and-get-value-after-on-change/29118530
        jQuery(".donation-form #state").focusin(function(e) {
          var element = jQuery(e.target || e.srcElement); // cross-browser event target selection
          element.data('val', element.val());
        });

        // TODO: Remove this when we have figured out the canada state/province issue
        jQuery(".donation-form #state").change(function(e) {
          var element = jQuery(e.target || e.srcElement); // cross-browser event target selection
          var prev = element.data('val');
          var current = element.val();
          var provinceElement = jQuery(".donation-form #province");
          var prevProvince = provinceElement.data('val');
          var currentProvince = provinceElement.val();
          Bloomerang.Util.addLog("State Changed: Target=" + e.target.name + ", PreValue=" + prev + ", Value=" + current + ", Province PreValue =" + prevProvince + ", Province CurrentValue =" + currentProvince);
        });

        // TODO: Remove this when we have figured out the canada state/province issue
        // We use the focusin function to save the previous value so we can log out the previous and new values on change
        // https://stackoverflow.com/questions/29118178/input-jquery-get-old-value-before-onchange-and-get-value-after-on-change/29118530
        jQuery(".donation-form #province").focusin(function(e) {
          var element = jQuery(e.target || e.srcElement); // cross-browser event target selection
          element.data('val', element.val());
        });

        // TODO: Remove this when we have figured out the canada state/province issue
        jQuery(".donation-form #province").change(function(e) {
          var element = jQuery(e.target || e.srcElement); // cross-browser event target selection
          var prev = element.data('val');
          var current = element.val();
          var stateElement = jQuery(".donation-form #state");
          var prevState = stateElement.data('val');
          var currentState = stateElement.val();
          Bloomerang.Util.addLog("Province Changed: Target=" + e.target.name + ", PreValue=" + prev + ", Value=" + current + ", State PrevValue=" + prevState + ", State Current=" + currentState);
        });

        // TODO: Remove this when we have figured out the canada state/province issue
        // We use the focusin function to save the previous value so we can log out the previous and new values on change
        // https://stackoverflow.com/questions/29118178/input-jquery-get-old-value-before-onchange-and-get-value-after-on-change/29118530
        jQuery(".donation-form #city").focusin(function(e) {
          var element = jQuery(e.target || e.srcElement); // cross-browser event target selection
          element.data('val', element.val());
        });

        // TODO: Remove this when we have figured out the canada state/province issue
        jQuery(".donation-form #city").change(function(e) {
          var element = jQuery(e.target || e.srcElement); // cross-browser event target selection
          var prev = element.data('val');
          var current = element.val();
          Bloomerang.Util.addLog("City Changed: Target=" + e.target.name + ", PreValue=" + prev + ", Value=" + current);
        });

        jQuery(".donation-form #phone-number").change(function () {
          var phoneField = jQuery(".donation-form #phone-number");
          var internationalNumber = phoneField.val().substring(0,1) === '+';
          phoneField.toggleClass("phoneUS", !internationalNumber);
          phoneField.toggleClass("phoneInternational", internationalNumber);
        })

        collectPayment = async function () {
          var form = jQuery("#donation-form");
          
          // donationFormReCaptchaV3Flag is always undefined on self hosted forms so it will use the V2 captcha for stripe
          if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey)) {
            if (!Bloomerang.ValidateDonationFormCaptcha() && Bloomerang.isForcePuzzle) {
              return false;
            }
          } else {
            if (!Bloomerang.ValidateDonationFormCaptcha()) {
              return false;
            }
          }

          if (!form.valid()) {
            return false;
          }
          
          var isEft = jQuery("#donation-form #CreditCard").length > 0 && 
                      !jQuery("#donation-form #CreditCard").prop("checked") && 
                      !jQuery("#donation-form #PayPalVenmo").prop("checked") && 
                      !jQuery("#donation-form #PayPal").prop("checked") && 
                      !jQuery("#donation-form #Venmo").prop("checked");
          
          if (Bloomerang.Util.isProcessorStripe() && !isEft && !Bloomerang.Util.StripeCardIsValid) {
            document.getElementById('card-errors').textContent = "Valid card info is required";
            return false;
          }
          
          if(Bloomerang.UsePaymentElement && !isEft && !Bloomerang.Util.RecurringStripeCardIsValid) {
            document.getElementById('card-errors').textContent = "Valid card info is required";
            return false;
          }
  
          if (isEft) {
            submitDonation();
          }
          else {
            var val = function (selector) { return jQuery(selector).val(); };
            var amount = Bloomerang.Util.getDonationAmount() + Bloomerang.Util.getDonationTrueImpactAmount();
            var selectedDonationLevel = jQuery(".donation-form .section.donation input[name='donation-level']:checked").parent().text();
            selectedDonationLevel = (selectedDonationLevel.indexOf("-") == -1 ? "" : selectedDonationLevel.substr(selectedDonationLevel.indexOf("-") + 2) );

            var oldMeta = '';
            if (jQuery('meta[name="viewport"]').length) {
              oldMeta = jQuery('meta[name="viewport"]').attr('content');
            } else {
              jQuery('head').append('<meta name="viewport" content="" />');
            }
            jQuery('meta[name="viewport"]').attr('content', 'width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1');
            jQuery('meta[name="viewport"]').attr('content', oldMeta);

            if (Bloomerang.Util.isProcessorStripe() || Bloomerang.Util.isProcessorOnePay()) {
              submitDonation();
            } else {
              SpreedlyExpress.setDisplayOptions({
                "amount": accounting.formatMoney(amount),
                "full_name": val(".donation-form #first-name") + " " + val(".donation-form #last-name"),
                "sidebar_bottom_description": selectedDonationLevel,
                "submit_label": "Donate"});
              SpreedlyExpress.setPaymentMethodParams({
                "email": val(".donation-form #email-address"),
                "phone_number": val(".donation-form #phone-number"),
                "address1": val(".donation-form #street-address"),
                "city": val(".donation-form #city"),
                "state": val(".donation-form #state") || val(".donation-form #province"),
                "zip": val(".donation-form #zip-code") || val(".donation-form #postal-code"),
                "country": val(".donation-form #country")});

              SpreedlyExpress.onPaymentMethod(function(token, paymentMethod) {
                Bloomerang.CreditCard.spreedlyToken(token);
                  submitDonation();
                });

              SpreedlyExpress.openView();
            }
          }
        };

        submitDonation = function() {
          if (!Bloomerang.continueFinancialSubmission(jQuery("#donation-form"))) { return false; }
  
          Bloomerang.Api.OnSubmit = Bloomerang.Widget.Donation.OnSubmit;
          Bloomerang.Api.OnSuccess = Bloomerang.Widget.Donation.OnSuccess;
          Bloomerang.Api.OnError = Bloomerang.Widget.Donation.OnError;

          var processingMessage = jQuery("#donation-processing-container");
          processingMessage.show();
          jQuery("#donation-form-container").hide();
          Bloomerang.scrollToElement(processingMessage);
  
          var tmp = jQuery(".donation-form #recurring").prop("checked")
            ? Bloomerang.Api.recurringDonate()
            : Bloomerang.Api.donate();
        };
        
        if(jQuery("#donation-form #DebitCard").length === 0 || jQuery("#donation-form #DebitCard").hasClass("hidden")) {
          jQuery("#donation-form #CreditCard").prop("checked", true);
        }
        else {
          jQuery("#donation-form #DebitCard").prop("checked", true);
        }
        
        
        jQuery("#donation-form .section.payment input[type='radio']").click(function() {
          Bloomerang.Util.calculateDonationTrueImpact();
          Bloomerang.Util.updateDonateButtonText();
          
          if (jQuery(this).attr("id") == "DebitCard" || jQuery(this).attr("id") == "CreditCard") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#paypal-button-container").hide();
            
            jQuery("#stripe-cc-fields").show();
            if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey)) {
              if(Bloomerang.isForcePuzzle) {
                jQuery(".donation-form .section.captcha").show();
              }
            } else {
              jQuery(".donation-form .section.captcha").show();
            }
            jQuery("#donation-form .btn-group").show();
          }
          else if(jQuery(this).attr("id") == "PayPalVenmo") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#stripe-cc-fields").hide();
            jQuery(".donation-form .section.captcha").hide();
            jQuery("#donation-form .btn-group").hide();
            
            jQuery("#paypal-button-container").show();
          }
          else if(jQuery(this).attr("id") == "PayPal") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#stripe-cc-fields").hide();
            jQuery(".donation-form .section.captcha").hide();
            jQuery("#donation-form .btn-group").hide();
            Bloomerang.Util.renderOnlyPayPal(false);
            jQuery("#paypal-button-container").show();
          }
          else if(jQuery(this).attr("id") == "Venmo") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#stripe-cc-fields").hide();
            jQuery(".donation-form .section.captcha").hide();
            jQuery("#donation-form .btn-group").hide();
            Bloomerang.Util.renderOnlyVenmo();
            jQuery("#paypal-button-container").show();
          }
          else {                   
            jQuery("#stripe-cc-fields").hide();
            jQuery("#paypal-button-container").hide();
            
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").show();
            if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey)) {
              if(Bloomerang.isForcePuzzle) {
                jQuery(".donation-form .section.captcha").show();
              }
            } else {
              jQuery(".donation-form .section.captcha").show();
            }
            jQuery("#donation-form .btn-group").show();
                    
            if (jQuery("#donation-form .sample-check").length == 0) {                    
              var checkImage = new Image();
              checkImage.src = 'https://s3-us-west-2.amazonaws.com/bloomerang-public-cdn/public-gallery/SampleCheck.png';
              jQuery(checkImage).addClass("sample-check");
              jQuery("#donation-form .accountNumber").after(checkImage);
            }
          }
          
        });
      
        jQuery("#donation-form .section.movedpayment input[type='radio']").click(function() {
          Bloomerang.Util.calculateDonationTrueImpact();
          Bloomerang.Util.updateDonateButtonText();
          if (Bloomerang.Data.PayPal.IsVenmoSameDayDonationEnabled && jQuery(".donation-form .field.start-date input").is(":visible")) {
            jQuery(".donation-form .field.start-date input").valid();
          }
          
          if (jQuery(this).attr("id") == "DebitCard" || jQuery(this).attr("id") == "CreditCard") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#paypal-button-container").hide();
            
            jQuery("#stripe-cc-fields").show();
            if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey)) {
              if(Bloomerang.isForcePuzzle) {
                jQuery(".donation-form .section.captcha").show();
              }
            } else {
                jQuery(".donation-form .section.captcha").show();
            }
            jQuery("#donation-form .btn-group").show();
          }
          else if(jQuery(this).attr("id") == "PayPalVenmo") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#stripe-cc-fields").hide();
            jQuery(".donation-form .section.captcha").hide();
            jQuery("#donation-form .btn-group").hide();
            
            jQuery("#paypal-button-container").show();
          }
          else if(jQuery(this).attr("id") == "PayPal") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#stripe-cc-fields").hide();
            jQuery(".donation-form .section.captcha").hide();
            jQuery("#donation-form .btn-group").hide();
            Bloomerang.Util.renderOnlyPayPal(jQuery(".donation-form .field.start-date input").val() > new Date().toISOString().split('T')[0]);
            jQuery("#paypal-button-container").show();
          }
          else if(jQuery(this).attr("id") == "Venmo") {
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").hide();
            jQuery("#stripe-cc-fields").hide();
            jQuery(".donation-form .section.captcha").hide();
            jQuery("#donation-form .btn-group").hide();
            Bloomerang.Util.renderOnlyVenmo();
            jQuery("#paypal-button-container").show();
          }
          else {                   
            jQuery("#stripe-cc-fields").hide();
            jQuery("#paypal-button-container").hide();
            
            jQuery("#donation-form .accountNumber, \
                    #donation-form .routingNumber, \
                    #donation-form .sample-check").show();
            if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey)) {
              if(Bloomerang.isForcePuzzle) {
                jQuery(".donation-form .section.captcha").show();
              }
            } else {
              jQuery(".donation-form .section.captcha").show();
            }
            jQuery("#donation-form .btn-group").show();
                    
            if (jQuery("#donation-form .sample-check").length == 0) {                    
              var checkImage = new Image();
              checkImage.src = 'https://s3-us-west-2.amazonaws.com/bloomerang-public-cdn/public-gallery/SampleCheck.png';
              jQuery(checkImage).addClass("sample-check");
              jQuery("#donation-form .accountNumber").after(checkImage);
            }
          }
          
        });
      
      jQuery("#donation-form #true-impact").change(function() {
        Bloomerang.Util.updateDonateButtonText();
      });

      // Show opt-in options based on the setting of the global opt-in
      jQuery(".donation-form .field.consent-all").change(function() { 
          jQuery(".donation-form .field.consent-all").siblings().each(function(i, e) { 
              jQuery(e).toggle();
          }); 
      });
        
})(jQuery);
    };
    
                var startBloomerangLoad = function() {
                    if (window.bloomerangLoadStarted == undefined) {
                        window.bloomerangLoadStarted = true;
                        var script = document.createElement('script');
                        script.type = 'text/javascript';
                        script.src = 'https://crm.bloomerang.co/Content/Scripts/Api/Bloomerang-v2.js?nocache=1768604272';
                        document.getElementsByTagName('head')[0].appendChild(script);
                        waitForBloomerangLoad(function() { Bloomerang.Util.requireJQueryValidationAndStripe(function() { insertForm4947968(); })});
                    }
                    else {
                        waitForBloomerangLoad(function() { Bloomerang.Util.requireJQueryValidationAndStripe(function() { insertForm4947968(); })});
                    }
                };

                var waitForBloomerangLoad = function(callback) {
                    if (typeof(Bloomerang) === 'undefined' || !Bloomerang._isReady) {
                        setTimeout(function () { waitForBloomerangLoad(callback) }, 500);
                    }
                    else {
                        if (true) {
                            callback();
                        } else {
                            window.bloomerangLoadStarted = undefined;
                            Bloomerang = undefined; // The version of Blomerang.js is not what we want. So blow it away and reload.
                            startBloomerangLoad();
                        }
                    }
                };

                startBloomerangLoad();
</script>

<!-- Mailing List Modal -->
<div class="mailing-list-modal-overlay" id="mailingListModal">
    <div class="mailing-list-modal">
        <button class="mailing-list-modal-close" onclick="closeMailingListModal()" aria-label="Close">&times;</button>
        <div class="mailing-list-modal-header">
            <h2>Join Our Mailing List</h2>
            <p>Stay connected with updates on programs, events, and stories from the SPARC community.</p>
        </div>
        <div class="mailing-list-modal-body">
            <script type="text/javascript" id="bloomerangForm719872"></script>
        </div>
    </div>
</div>
<script type="text/javascript">
    var insertForm719872 = function() {
        var html719872 = '<style text=\'text/css\'>' +
'.email-registration-form label{color: #404040;' +
'                display: block;}' +
'' +
'.email-registration-form label.error{color:#900;' +
'                display: inline-block; ' +
'                padding: 0 10px;}' +
'' +
'.email-registration-form .field{padding: 4px 0;}' +
'' +
'.email-registration-form .consent{padding-bottom: 4px;}' +
'' +
'.email-registration-form .field .required-star{color: #aa0000; ' +
'                display: inline-block; ' +
'                margin-left: 5px;}' +
'' +
'.email-registration-form .field .checkboxes{max-width:275px;' +
'                border: 1px solid #A9A9A9;' +
'                -webkit-transition: all .3s ease-out;' +
'                -moz-transition: all .3s ease-out;' +
'                transition: all .3s ease-out;}' +
'' +
'.email-registration-form .field .checkbox{display:block;' +
'                position:relative;' +
'                -moz-box-sizing:border-box;' +
'                box-sizing:border-box;' +
'                height:30px;' +
'                line-height:26px;' +
'                padding:2px 28px 2px 8px;' +
'                border-bottom:1px solid rgba(0,0,0,0.1);' +
'                color:#404040;  ' +
'                overflow:hidden;' +
'                text-decoration:none; }' +
'' +
'.email-registration-form .field .checkbox input{opacity:0.01;' +
'                position:absolute;' +
'                left:-50px;  ' +
'                z-index:-5;}' +
'' +
'.email-registration-form .field .checkbox:last-child{border-bottom:none;}' +
'' +
'.email-registration-form .field .checkbox.selected{background: rgb(50, 142, 253);' +
'                color:#fff; }' +
'' +
'.email-registration-form .field .checkbox.selected:before{color:#fff;' +
'                line-height:30px;' +
'                position:absolute;' +
'                right:10px; }' +
'' +
'.email-registration-form .field input{padding: 4px; ' +
'                width: 275px;}' +
'' +
'.email-registration-form .errors{border: 1px solid #900;' +
'                color: #900;  ' +
'                padding: 10px;}' +
'' +
'.email-registration-form .hidden{display: none;}' +
'' +
'.btn-group .btn-submit-email{padding: 4px 10px;}' +
'' +
'input, select, textarea, button{font-family: inherit;}' +
'' +
'</style>' +
'' +
'<div id="email-registration-form-container">' +
'  <form id="email-registration-form" class="email-registration-form" method="post" action="javascript:void(0)">' +
'    <div class="errors hidden"></div>' +
'    <div class="section contact">' +
'      <h3>Contact Information</h3>' +
'      <div class="field text first-name required" >' +
'<label for="first-name"><span class="label">First Name</span><span class="required-star">*</span></label>' +
'<input id="first-name" name="first-name" class="required" type="text"></input>' +
'</div>' +
'<div class="field text last-name required" >' +
'<label for="last-name"><span class="label">Last Name</span><span class="required-star">*</span></label>' +
'<input id="last-name" name="last-name" class="required" type="text"></input>' +
'</div>' +
'<div class="field email email-address required" >' +
'<label for="email-address"><span class="label">Email</span><span class="required-star">*</span></label>' +
'<input id="email-address" name="email-address" class="email required" type="email" placeholder="someone@website.com"></input>' +
'</div>' +
'<div class="consent">I want to receive emails at this address</div>' +
'' +
'</div>' +
'    ' +
'    <div class="section captcha">' +
'      <label id=\'noCaptchaResponseError\' class=\'error noCaptchaResponseError\' style=\'display: none\'>You must fill out the CAPTCHA</label><div id="captcha719872"></div>' +
'' +
'</div>' +
'    <div class="btn-group">' +
'      <input class="btn btn-submit btn-submit-email" type="submit" value="Sign up"/>' +
'    </div>' +
'  </form>' +
'</div>' +
'' +
'' +  '';var successHtml719872 = '<div class=\'donation-success\'>' +
                                                       '  <h2>Thank you for Registering!</h2>' +
                                                       '  <p>Your email address has been added to our mailing list.</p>' +
                                                        '   ' +
                                                        '</div>';( function($) {if (!Bloomerang.useEmailId('719872')) {
                                    html719872 = '<p style="color: red">Only one email sign-up form can be used on each page.</p>';
                                }
                                Bloomerang.Util.requireStripe();if (jQuery('#bloomerangForm719872').length) {

                        jQuery('#bloomerangForm719872').after(html719872);




                    };
                    if (Bloomerang.emailSignupFormLoaded) {
                                            return false;
                                        }
                                        Bloomerang.emailSignupFormLoaded = true;

                        Bloomerang.reCaptchaV3SiteKey = '6LeH9PUrAAAAAN0wv9VTVahiByfF9sGDQglOBEYK';
                        Bloomerang.gRecaptchaV3Threshold = 0.5;

                        window.captchaLoadCallback = function() {
                            Bloomerang.gRecaptchaLoaded = true;
                        };

                        window.captchaV3LoadCallback = function() {
                            Bloomerang.gRecaptchaV3Loaded = true;
                        };

                        if(Bloomerang.donationFormReCaptchaV3SelfHostedFlag === undefined) {
                            function success (result) {
                                Bloomerang.donationFormReCaptchaV3SelfHostedFlag = result.DonationFormReCaptchaV3SelfHostedFlag;
                                initializeCaptcha();
                            }

                            function failure (result) {
                                Bloomerang.donationFormReCaptchaV3SelfHostedFlag = false;
                                initializeCaptcha();
                            }

                            Bloomerang.Api._post('v1/ReCaptchaV3SelfHostedFlag', {}, success, failure);
                        } else {
                            initializeCaptcha();
                        }

                        async function getRecaptchaV3Token() {
                              const token = await new Promise((resolve, reject) => {
                                 grecaptcha.ready(function() {
                                    grecaptcha.execute(Bloomerang.reCaptchaV3SiteKey, {action: 'submit'}).then(function(token) {
                                       resolve(token);
                                     });
                                  });
                                });

                                return token;
                        }

                        function initializeCaptcha() {
                            Bloomerang.Util.load('https://www.google.com/recaptcha/api.js?onload=captchaLoadCallback&render=explicit',
                                function() { return Bloomerang.gRecaptchaLoaded; },
                                function() {
                                    jQuery('.section.captcha').removeAttr('style');
                                    jQuery('form.email-registration-form').data('captcha-id', grecaptcha.render('captcha719872', { 'sitekey' : '6LdM9EsrAAAAAGOAM46W9nBGf3WNXrN1bZ6PQWed' }));

                                    if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm && Bloomerang.isDonationForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.reCaptchaV3SiteKey && Bloomerang.isDonationForm)) {
                                        jQuery('.section.captcha').attr('style', 'display: none');
                                    }
                                },
                                true,
                                true);

                            if((Bloomerang.donationFormReCaptchaV3Flag && Bloomerang.isBloomerangHostedForm && Bloomerang.isDonationForm) || (Bloomerang.donationFormReCaptchaV3SelfHostedFlag && !Bloomerang.isBloomerangHostedForm && Bloomerang.isDonationForm && Bloomerang.reCaptchaV3SiteKey)) {
                                 Bloomerang.Util.load('https://www.google.com/recaptcha/api.js?onload=captchaV3LoadCallback&render=' + Bloomerang.reCaptchaV3SiteKey,
                                    function() { return Bloomerang.gRecaptchaV3Loaded; },
                                    function() {
                                        grecaptcha.ready(function() {
                                          grecaptcha.execute(Bloomerang.reCaptchaV3SiteKey, {action: 'submit'}).then(function(token) {
                                              async function success (result) {
                                                if(parseFloat(result.Score) < Bloomerang.gRecaptchaV3Threshold) {
                                                    Bloomerang.isForcePuzzle = true;
                                                    jQuery('.section.captcha').attr('style', 'display: block');
                                                } else {

                                                    const initialRecaptchaV3Token = await getRecaptchaV3Token();

                                                     // Append to the form data container to be included when submitting the form on bloomerangV2.js
                                                     Bloomerang.captchaResponseV3(initialRecaptchaV3Token);

                                                     setInterval(async ()=> {
                                                         const recaptchaV3Token = await getRecaptchaV3Token();

                                                        // Append to the form data container to be included when submitting the form on bloomerangV2.js
                                                        Bloomerang.captchaResponseV3(recaptchaV3Token);
                                                     }, 80000);
                                                }
                                               }

                                               function failure (result) {
                                                Bloomerang.isForcePuzzle = true;
                                                jQuery('.section.captcha').attr('style', 'display: block');
                                               }

                                               var data = {
                                                  token: token,
                                                  isSelfHosted: !Bloomerang.isBloomerangHostedForm
                                               };

                                                Bloomerang.Api._post('v1/ReCaptchaV3', data, success, failure);
                                          });
                                        });
                                    },
                                    true,
                                    true);
                               }
                           }


                    Bloomerang.useKey('pub_0671a94c-634e-11f0-9fbb-06179723032d');

        // Register proper callbacks for various stages/outcomes of submission
        Bloomerang.Widget.Email.OnSubmit = function (args) {
            jQuery(".btn-submit-email").val("Registering...").prop("disabled", true).addClass("disabled");
            var val = function (selector) { return jQuery(selector).val(); };
            Bloomerang.Account
                    .individual()
                    .firstName(val(".email-registration-form #first-name"))
                    .lastName(val(".email-registration-form #last-name"))
                    .homeEmail(val(".email-registration-form #email-address"))
                    .applyEmailSignupCustomFields();

           Bloomerang.Interaction.applyEmailSignupCustomFields();
        };
        Bloomerang.ValidateEmailSignupFormCaptcha = function() {
            if (typeof(grecaptcha) !== "undefined" && jQuery("#captcha" + Bloomerang.Data.WidgetIds.EmailSignup).children().length) {
                var captchaResponse = grecaptcha.getResponse(jQuery(".email-registration-form").data("captcha-id"));
                if (captchaResponse) {
                    jQuery(".email-registration-form .noCaptchaResponseError").hide();
                    Bloomerang.captchaResponse(captchaResponse);
                    return true;
                } else {
                    jQuery(".email-registration-form .noCaptchaResponseError").show();
                    return false;
                }
            } else return true;
        };
        Bloomerang.Api.OnSuccess = Bloomerang.Widget.Email.OnSuccess = function (response) {
            jQuery("#email-registration-form-container").html(successHtml719872);
            var distance = 100;
            var offset = jQuery("#email-registration-form-container").offset().top;
            var offsetTop = offset > distance ? offset - distance : offset;
                jQuery('html, body').animate({ scrollTop : offsetTop}, 500);
        };
        Bloomerang.Api.OnError = Bloomerang.Widget.Email.OnError = function (response) {
            jQuery(".btn-submit-email").val("Register").prop("disabled", false).removeClass("disabled");
            jQuery("#email-registration-form-container .errors").removeClass("hidden").html(response.Message);
            var distance = 100;
            var offset = jQuery("#email-registration-form-container .errors").offset().top;
            var offsetTop = offset > distance ? offset - distance : offset;
                jQuery('html, body').animate({ scrollTop : offsetTop}, 500);
            if (typeof(grecaptcha) !== "undefined" && jQuery("#captcha" + Bloomerang.Data.WidgetIds.EmailSignup).children().length) {
              grecaptcha.reset(jQuery(".email-registration-form").data("captcha-id"));
            }
        };

        Bloomerang.Util.applyEmailSignupCustomFields = function (obj, type) {

            // Clear any fields from a previous failed submission
            obj.clearCustomFields();

            // Apply all <input> (not multiselect), <select> and <textarea> fields
            jQuery(".email-registration-form .section.custom-fields :input:not(a > input, select)[id*=" + type + "]").each(function() {
                if (jQuery(this).val().hasValue()) {
                    obj.customFreeformField(jQuery(this).attr("id").toUntypedValue(), jQuery(this).val());
                }
            });

            // Apply all <select> fields
            jQuery(".email-registration-form .section.custom-fields select[id*=" + type + "]").each(function() {
                if (jQuery(this).val().hasValue()) {
                    obj.customPickField(jQuery(this).attr("id").toUntypedValue(), jQuery(this).val());
                }
            });

            // Apply all multiselect fields
            jQuery(".email-registration-form .section.custom-fields .checkboxes[id*=" + type + "]").each(function() {
                obj.customPickField(jQuery(this).attr("id").toUntypedValue(),
                jQuery.map(jQuery(this).children(".checkbox.selected"), function(v) { return jQuery(v).attr("data-id"); }));
            });
        };

        String.prototype.hasValue = function() {
            return (this && jQuery.trim(this)); //IE8 doesn't have a native trim function
        };

        Bloomerang.Account.applyEmailSignupCustomFields = function () {
            Bloomerang.Util.applyEmailSignupCustomFields(this, "Account");
            return this;
        };

        Bloomerang.Interaction.applyEmailSignupCustomFields = function () {
            Bloomerang.Util.applyEmailSignupCustomFields(this, "Interaction");
            return this;
        };

        String.prototype.toUntypedValue = function() {
            return this.substring(this.indexOf('_') + 1);
        };

        jQuery.validator.addMethod("currency", function (value, element, options) {
            return !value ||
                value
                  .replace("$", "")
                  .replace(".", "")
                  .split(",").join("")
                  .match(/^\d+$/g);
        }, "Not a valid currency");

        jQuery.validator.classRuleSettings.currency = { currency: true };

        jQuery.validator.addMethod("number", function (value, element, options) {
            return !value ||
                value
                  .replace(".", "")
                  .split(",").join("")
                  .match(/^\d+$/g);
        }, "Not a valid number");

        jQuery.validator.classRuleSettings.number = { number: true };

        jQuery.validator.addMethod("validYear", function (value, element, options) {
            try {
                return (!value || value.match(/^[1-9]\d\d\d$/)) ? true : false;
            }
            catch (e) {
                return false;
            }
        }, function () { return "Must be a 4 digit year"; });

        jQuery.validator.classRuleSettings.validYear = { validYear: true };

        // Intercept form submission to validate then submit via API
        jQuery("#email-registration-form-container form").validate({
            submitHandler: function () {
                if (!Bloomerang.ValidateEmailSignupFormCaptcha()) {
                  return false;
                }

                // Restore proper callbacks in case there are multiple widgets on the page
                Bloomerang.Api.OnSubmit = Bloomerang.Widget.Email.OnSubmit;
                Bloomerang.Api.OnSuccess = Bloomerang.Widget.Email.OnSuccess;
                Bloomerang.Api.OnError = Bloomerang.Widget.Email.OnError;
                Bloomerang.Api.joinMailingList();
            }
        });

})(jQuery);
    };

                var startBloomerangLoadEmail = function() {
                    if (window.bloomerangLoadStarted == undefined) {
                        window.bloomerangLoadStarted = true;
                        var script = document.createElement('script');
                        script.type = 'text/javascript';
                        script.src = 'https://crm.bloomerang.co/Content/Scripts/Api/Bloomerang-v2.js?nocache=1768604272';
                        document.getElementsByTagName('head')[0].appendChild(script);
                        waitForBloomerangLoadEmail(function() { Bloomerang.Util.requireJQueryValidation(function() { insertForm719872(); })});
                    }
                    else {
                        waitForBloomerangLoadEmail(function() { Bloomerang.Util.requireJQueryValidation(function() { insertForm719872(); })});
                    }
                };

                var waitForBloomerangLoadEmail = function(callback) {
                    if (typeof(Bloomerang) === 'undefined' || !Bloomerang._isReady) {
                        setTimeout(function () { waitForBloomerangLoadEmail(callback) }, 500);
                    }
                    else {
                        if (true) {
                            callback();
                        } else {
                            window.bloomerangLoadStarted = undefined;
                            Bloomerang = undefined;
                            startBloomerangLoadEmail();
                        }
                    }
                };

                startBloomerangLoadEmail();
</script>

</body>
</html>
